1819751b17950db85f2.99018777install/PopulateSeedData.php:106:$result = $current_user->retrieve_entity_info($assigned_user_id,'Users');
Popup.php:252:	if($currency_id == null) $currency_id = fetchCurrency($current_user->id);
Smarty_setup.php:44:		$this->assign('CURRENT_USER_ID',$current_user->id);
Smarty_setup.php:49:            $this->assign('TAG_CLOUD_DISPLAY', self::lookupTagCloudView($current_user->id) );
cron/modules/SalesOrder/RecurringInvoice.service:99:		$current_user->id = 1;
cron/modules/SalesOrder/RecurringInvoice.service:100:		$current_user = $current_user->retrieve_entity_info($current_user->id, "Users");
data/CRMEntity.php:143:		$params1 = array($current_id, $current_user->id, $ownerid, $module . " Attachment", '', $adb->formatDate($date_var, true), $adb->formatDate($date_var, true));
data/CRMEntity.php:176:			$ownerid = $current_user->id;
data/CRMEntity.php:209:				$params1 = array($current_id, $current_user->id, $ownerid, $module . " Image", $this->column_fields['description'], $adb->formatDate($date_var, true), $adb->formatDate($date_var, true));
data/CRMEntity.php:212:				$params1 = array($current_id, $current_user->id, $ownerid, $module . " Attachment", $this->column_fields['description'], $adb->formatDate($date_var, true), $adb->formatDate($date_var, true));
data/CRMEntity.php:282:			$ownerid = $current_user->id;
data/CRMEntity.php:295:			require('user_privileges/user_privileges_' . $current_user->id . '.php');
data/CRMEntity.php:299:				$params = array($ownerid, $current_user->id, $description_val, $adb->formatDate($date_var, true), $this->id);
data/CRMEntity.php:310:					$params = array($ownerid, $current_user->id, $description_val, $adb->formatDate($date_var, true), $this->id);
data/CRMEntity.php:313:					$params = array($ownerid, $current_user->id, $adb->formatDate($date_var, true), $this->id);
data/CRMEntity.php:320:			if ($ownerid != $current_user->id) {
data/CRMEntity.php:329:			if ($current_user->id == '')
data/CRMEntity.php:330:				$current_user->id = 0;
data/CRMEntity.php:347:			$params = array($current_id, $current_user->id, $ownerid, $module, $description_val, $current_user->id, $created_date_var, $modified_date_var);
data/CRMEntity.php:394:			require('user_privileges/user_privileges_' . $current_user->id . '.php');
data/CRMEntity.php:515:					if (isset($current_user->date_format) && !$ajaxSave) {
data/CRMEntity.php:554:						$res = $adb->pquery($query, array($current_user->id));
data/CRMEntity.php:912:		$this->db->pquery($query, array($this->db->formatDate($date_var, true), $current_user->id, $id), true, "Error marking record deleted: ");
data/CRMEntity.php:1054:			if (getFieldVisibilityPermission($currentModule, $current_user->id, $fieldname) != '0')
data/CRMEntity.php:1109:			if (getFieldVisibilityPermission($module, $current_user->id, $key, 'readwrite') == '0')
data/CRMEntity.php:1151:		$freetag->delete_all_object_tags_for_user($current_user->id, $id);
data/CRMEntity.php:1154:		$this->db->pquery($sql_recentviewed, array($current_user->id, $id));
data/CRMEntity.php:1226:		$this->db->pquery($query, array($this->db->formatDate($date_var, true), $current_user->id, $id), true, "Error restoring records :");
data/CRMEntity.php:1754:						&& getFieldVisibilityPermission($related_module, $current_user->id, $dependentField, 'readwrite') == '0') {
data/CRMEntity.php:1956:			require('user_privileges/user_privileges_' . $current_user->id . '.php');
data/CRMEntity.php:1957:			require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
data/CRMEntity.php:1959:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '" . $current_user_parent_role_seq . "::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=" . $current_user->id . " and tabid=" . $tabid . ") or (";
data/CRMEntity.php:1964:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=" . $current_user->id . " and tabid=" . $tabid . "))) ";
data/CRMEntity.php:1978:			require('user_privileges/user_privileges_' . $current_user->id . '.php');
data/CRMEntity.php:1979:			require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
data/CRMEntity.php:1981:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '" . $current_user_parent_role_seq . "::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=" . $current_user->id . " and tabid=" . $tabid . ") or (";
data/CRMEntity.php:1986:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=" . $current_user->id . " and tabid=" . $tabid . "))) ";
data/CRMEntity.php:2091:			$focus1->column_fields['assigned_user_id'] = $current_user->id;
data/CRMEntity.php:2092:			$focus1->column_fields['modified_user_id'] = $current_user->id;
data/CRMEntity.php:2096:			$last_import->assigned_user_id = $current_user->id;
data/CRMEntity.php:2392:		$adb->pquery('UPDATE vtiger_crmentity SET modifiedtime = ?, modifiedby = ? WHERE crmid = ?', array($currentTime, $current_user->id, $crmid));
data/CRMEntity.php:2461:		$adb->pquery('UPDATE vtiger_crmentity SET modifiedtime = ?, modifiedby = ? WHERE crmid = ?', array($currentTime, $current_user->id, $crmid));
graph.php:60:	$result = $current_user->retrieveCurrentUserInfoFromFile($_SESSION['authenticated_user_id']);
graph.php:74:	if (!empty($current_user->language)) {
graph.php:75:		$current_language = $current_user->language;
graph.php:85:	if (!empty($current_user->theme)) {
graph.php:86:		$theme = $current_user->theme;
include/Ajax/TagCloud.php:17:$userid = $current_user->id;
include/ComboUtil.php:22:        $roleid=$current_user->roleid;
include/CustomFieldUtil.php:241:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/fields/CurrencyField.php:170:			$currencySymbolPlacement = $current_user->currency_symbol_placement;
include/fields/DateTimeField.php:81:		$format = $current_user->date_format;
include/fields/DateTimeField.php:141:		$format = $current_user->date_format;
include/home.php:16:require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/home.php:45:		$params= array($stuffid,$sequence,$this->stufftype,$current_user->id,0,$this->stufftitle);
include/home.php:91:			$userid = $current_user->id;
include/home.php:99:			$userid = $current_user->id;
include/home.php:126:		$resultstuff=$adb->pquery($querystuff, array($current_user->id));
include/home.php:310:                            $fld_permission = getFieldVisibilityPermission($modname,$current_user->id,$fldname);
include/home.php:501:		$result = $adb->pquery($sql, array($notebookid,$current_user->id));
include/home.php:538:	$userid= $current_user->id;
include/ListView/ListView.php:245:		$current_user->setPreference($this->local_current_module."_".$localVarName."_".$varName, $value);
include/ListView/ListViewController.php:590:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/ListView/ListViewPagging.php:38:			$where = '(' . getTagWhere($searchValue, $current_user->id) . ')';
include/quickcreate.php:42:$smarty->assign("USERID",$current_user->id);
include/RelatedListView.php:316:				if((getFieldVisibilityPermission('Documents', $current_user->id, 'notecontent') == '0') || $row['activitytype'] == 'Documents')
include/RelatedListView.php:330:				if((getFieldVisibilityPermission('Documents', $current_user->id, 'filename') == 0))
include/RelatedListView.php:334:					$prof_id = fetchUserProfileId($current_user->id);
include/RelatedListView.php:438:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/RelatedListView.php:439:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/RelatedListView.php:587:	if(getFieldVisibilityPermission('Products', $current_user->id, 'productcode') == '0')
include/RelatedListView.php:589:	if(getFieldVisibilityPermission('Products', $current_user->id, 'unit_price') == '0')
include/RelatedListView.php:609:		if(getFieldVisibilityPermission('Products', $current_user->id, 'productcode') == '0')
include/RelatedListView.php:611:		if(getFieldVisibilityPermission('Products', $current_user->id, 'unit_price') == '0')
include/RelatedListView.php:641:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/RelatedListView.php:646:	if(getFieldVisibilityPermission($module, $current_user->id, $fieldname) == '0') {
include/saveMergeCriteria.php:25:		$adb->pquery("DELETE FROM vtiger_user2mergefields WHERE tabid=? AND userid=?", array($tabid, $current_user->id));
include/saveMergeCriteria.php:30:			array($current_user->id, $tabid, $merge_fieldid, 1));
include/utils/CommonUtils.php:219:	if ($current_user->date_format == 'dd-mm-yyyy') {
include/utils/CommonUtils.php:221:	} elseif ($current_user->date_format == 'mm-dd-yyyy') {
include/utils/CommonUtils.php:223:	} elseif ($current_user->date_format == 'yyyy-mm-dd') {
include/utils/CommonUtils.php:566:		if (getFieldVisibilityPermission("Contacts", $current_user->id, 'firstname') == '0') {
include/utils/CommonUtils.php:593:		if (getFieldVisibilityPermission("Leads", $current_user->id, 'firstname') == '0') {
include/utils/CommonUtils.php:848:	$dat_fmt = $current_user->date_format;
include/utils/CommonUtils.php:1091:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/CommonUtils.php:1201:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/CommonUtils.php:1819:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/CommonUtils.php:1876:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/CommonUtils.php:1877:	require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
include/utils/CommonUtils.php:1880:		$users_combo = get_select_options_array(get_user_array(FALSE, "Active", $current_user->id, 'private'), $current_user->id);
include/utils/CommonUtils.php:1882:		$users_combo = get_select_options_array(get_user_array(FALSE, "Active", $current_user->id), $current_user->id);
include/utils/CommonUtils.php:1902:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/CommonUtils.php:1903:	require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
include/utils/CommonUtils.php:1916:			$groups_combo = get_select_options_array(get_group_array(FALSE, "Active", $current_user->id, 'private'), $current_user->id);
include/utils/CommonUtils.php:1918:			$groups_combo = get_select_options_array(get_group_array(FALSE, "Active", $current_user->id), $current_user->id);
include/utils/CommonUtils.php:2007:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/CommonUtils.php:3071:			if($module == 'Users' || getColumnVisibilityPermission($current_user->id, $field, $module) == '0') {
include/utils/CommonUtils.php:3216:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/DetailViewUtils.php:54:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/DetailViewUtils.php:55:	require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
include/utils/DetailViewUtils.php:146:		$roleid = $current_user->roleid;
include/utils/DetailViewUtils.php:206:		$roleid = $current_user->roleid;
include/utils/DetailViewUtils.php:286:			$assigned_user_id = $current_user->id;
include/utils/DetailViewUtils.php:359:			$assigned_user_id = $current_user->id;
include/utils/DetailViewUtils.php:368:			$users_combo = get_select_options_array(get_user_array(FALSE, "Active", $current_user->id, 'private'), $assigned_user_id);
include/utils/DetailViewUtils.php:370:			$users_combo = get_select_options_array(get_user_array(FALSE, "Active", $current_user->id), $assigned_user_id);
include/utils/DetailViewUtils.php:375:				$groups_combo = get_select_options_array(get_group_array(FALSE, "Active", $current_user->id, 'private'), $current_user->id);
include/utils/DetailViewUtils.php:377:				$groups_combo = get_select_options_array(get_group_array(FALSE, "Active", $current_user->id), $current_user->id);
include/utils/DetailViewUtils.php:400:			$fieldpermission = getFieldVisibilityPermission($currentModule, $current_user->id, 'firstname');
include/utils/DetailViewUtils.php:405:			$roleid = $current_user->roleid;
include/utils/DetailViewUtils.php:418:				$params = array($current_user->roleid);
include/utils/DetailViewUtils.php:1066:			if ($current_user->theme == $theme) {
include/utils/DetailViewUtils.php:1081:			if ($current_user->language == $prefix) {
include/utils/DetailViewUtils.php:1502:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/DetailViewUtils.php:1550:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/DetailViewUtils.php:1601:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/EditViewUtils.php:50:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/EditViewUtils.php:51:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/EditViewUtils.php:152:				$fieldvalue[] = array($date_format=>$current_user->date_format.' '.$app_strings['YEAR_MONTH_DATE']);
include/utils/EditViewUtils.php:155:				$fieldvalue[] = array($date_format=>$current_user->date_format);
include/utils/EditViewUtils.php:159:			$fieldvalue[] = array($date_format=>$current_user->date_format.' '.$app_strings['YEAR_MONTH_DATE']);
include/utils/EditViewUtils.php:200:		$roleid=$current_user->roleid;
include/utils/EditViewUtils.php:228:		$roleid=$current_user->roleid;
include/utils/EditViewUtils.php:294:			$assigned_user_id = $current_user->id;
include/utils/EditViewUtils.php:343:				$assigned_user_id = $current_user->id;
include/utils/EditViewUtils.php:410:			$fieldpermission = getFieldVisibilityPermission($module_name, $current_user->id,'firstname', 'readwrite');
include/utils/EditViewUtils.php:415:			$fieldpermission = getFieldVisibilityPermission($module_name, $current_user->id,'salutationtype', 'readwrite');
include/utils/EditViewUtils.php:417:				$roleid=$current_user->roleid;
include/utils/EditViewUtils.php:570:			$assigned_user_id = $current_user->id;
include/utils/EditViewUtils.php:1357:			if($current_user->theme == $theme) {
include/utils/EditViewUtils.php:1370:			if($current_user->language == $prefix) {
include/utils/EditViewUtils.php:1431:		if (getFieldVisibilityPermission('SalesOrder', $current_user->id,$xyz[$i]) == '0'){
include/utils/EditViewUtils.php:1483:		if (getFieldVisibilityPermission('Quotes', $current_user->id,$xyz[$i]) == '0'){
include/utils/EditViewUtils.php:1527:			if (getFieldVisibilityPermission('Quotes', $current_user->id,$xyz[$i]) == '0'){
include/utils/export.php:46:	$result = $current_user->retrieveCurrentUserInfoFromFile($_SESSION['authenticated_user_id'],"Users");
include/utils/export.php:282:		$roleid = fetchUserRole($current_user->id);
include/utils/ExportUtils.php:54:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/InventoryUtils.php:155:		$body = str_replace('{CURRENTUSER}',$current_user->user_name,$body);
include/utils/InventoryUtils.php:157:		$mail_status = send_mail($module,$to_address,$current_user->user_name,$current_user->email1,decode_html($subject),nl2br(to_html($body)));
include/utils/InventoryUtils.php:938:			$user_currency_id = fetchCurrency($current_user->id);
include/utils/InventoryUtils.php:1016:		$params = array(fetchCurrency($current_user->id));
include/utils/InventoryUtils.php:1058:			if(getFieldVisibilityPermission($module,$current_user->id,'unit_price') == '0') {
include/utils/ListViewUtils.php:73:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:239:					if ((getFieldVisibilityPermission('Events', $current_user->id, 'eventstatus') == '0') || (getFieldVisibilityPermission('Calendar', $current_user->id, 'taskstatus') == '0')) {
include/utils/ListViewUtils.php:304:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:349:		require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:511:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:684:									if (getFieldVisibilityPermission('Calendar', $current_user->id, $fieldname) == '0') {
include/utils/ListViewUtils.php:690:									if (getFieldVisibilityPermission('Events', $current_user->id, $fieldname) == '0') {
include/utils/ListViewUtils.php:929:								if (getFieldVisibilityPermission('Calendar', $current_user->id, $fieldname) == '0') {
include/utils/ListViewUtils.php:936:								if (getFieldVisibilityPermission('Events', $current_user->id, $fieldname) == '0') {
include/utils/ListViewUtils.php:955:							if ((getFieldVisibilityPermission('Events', $current_user->id, 'eventstatus') == '0') || (getFieldVisibilityPermission('Calendar', $current_user->id, 'taskstatus') == '0')) {
include/utils/ListViewUtils.php:1040:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:1179:				require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:1190:				if (getFieldVisibilityPermission($module, $current_user->id, 'unit_price') == '0') {
include/utils/ListViewUtils.php:1233:				require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:1244:				if (getFieldVisibilityPermission($module, $current_user->id, 'unit_price') == '0') {
include/utils/ListViewUtils.php:1287:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:1388:			$roleid = $current_user->roleid;
include/utils/ListViewUtils.php:1680:				$roleid = $current_user->roleid;
include/utils/ListViewUtils.php:1784:							if (getFieldVisibilityPermission($module, $current_user->id, $xyz[$i]) == '0') {
include/utils/ListViewUtils.php:1844:					if (getFieldVisibilityPermission('Products', $current_user->id, 'unit_price') == '0') {
include/utils/ListViewUtils.php:1894:					if (getFieldVisibilityPermission($module, $current_user->id, 'unit_price') == '0') {
include/utils/ListViewUtils.php:1940:					if (getFieldVisibilityPermission('Services', $current_user->id, 'unit_price') == '0') {
include/utils/ListViewUtils.php:1978:						if (getFieldVisibilityPermission($module, $current_user->id, $xyz[$i]) == '0') {
include/utils/ListViewUtils.php:2020:							if (getFieldVisibilityPermission('Accounts', $current_user->id, $xyz[$i]) == '0') {
include/utils/ListViewUtils.php:2148:						if (getFieldVisibilityPermission($module, $current_user->id, $xyz[$i]) == '0') {
include/utils/ListViewUtils.php:2262:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:2263:	require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:2743:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:2744:	require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:3146:			if ($current_user->activity_view == "This Year") {
include/utils/ListViewUtils.php:3148:			} else if ($current_user->activity_view == "This Month") {
include/utils/ListViewUtils.php:3150:			} else if ($current_user->activity_view == "This Week") {
include/utils/ListViewUtils.php:3934:		$result = $adb->pquery($sql, array($tabid, $current_user->id));
include/utils/ListViewUtils.php:3939:	$user_profileid = fetchUserProfileId($current_user->id);
include/utils/ListViewUtils.php:3949:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
include/utils/ListViewUtils.php:4047:			if ($current_user->activity_view == "This Year") {
include/utils/ListViewUtils.php:4049:			} else if ($current_user->activity_view == "This Month") {
include/utils/ListViewUtils.php:4051:			} else if ($current_user->activity_view == "This Week") {
include/utils/SearchUtils.php:59:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/SearchUtils.php:431:								if($input['operator'] == 'e' && getFieldVisibilityPermission("Calendar", $current_user->id,'taskstatus') == '0' && ($column_name == "status" || $column_name == "eventstatus")){
include/utils/SearchUtils.php:433:								}else if(getFieldVisibilityPermission("Calendar", $current_user->id,'taskstatus') == '0' && ($column_name == "status" || $column_name == "eventstatus"))
include/utils/SearchUtils.php:447:						if(getFieldVisibilityPermission("Calendar", $current_user->id,'taskstatus') == '0' && ($table_name == "vtiger_activity" && ($column_name == "status" || $column_name == "eventstatus")))
include/utils/SearchUtils.php:541:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/SearchUtils.php:1060:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/SearchUtils.php:1203:							if(getFieldVisibilityPermission("Calendar", $current_user->id,'taskstatus') == '0') {
include/utils/SearchUtils.php:1419:			if(getFieldVisibilityPermission("Calendar", $current_user->id,'taskstatus') == '0')
include/utils/UserInfoUtil.php:753:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:754:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:884:		if($current_user->id == $recOwnId)
include/utils/UserInfoUtil.php:1045:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:1186:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:1360:					if($rec_owner_id != $current_user->id)
include/utils/UserInfoUtil.php:3544:        require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:3563:        require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:3584:        require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:3614:	$result=$adb->pquery($query, array($current_user->id, $tabid));
include/utils/UserInfoUtil.php:3635:	$result=$adb->pquery($query, array($current_user->id, $tabid));
include/utils/UserInfoUtil.php:3656:	$result=$adb->pquery($query, array($current_user->id, $tabid));
include/utils/UserInfoUtil.php:3703:        	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:3704:        	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:3709:						vtiger_crmentity.smownerid in($current_user->id)
include/utils/UserInfoUtil.php:3711:						or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")
include/utils/UserInfoUtil.php:3718:                         $sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3722:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) " .
include/utils/UserInfoUtil.php:3724:				"or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or (";
include/utils/UserInfoUtil.php:3730:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3735:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) " .
include/utils/UserInfoUtil.php:3737:				"or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or (";
include/utils/UserInfoUtil.php:3743:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3748:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) " .
include/utils/UserInfoUtil.php:3750:				"or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")";
include/utils/UserInfoUtil.php:3758:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3763:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") ";
include/utils/UserInfoUtil.php:3770:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3775:		$sec_query .= " and vtiger_crmentity.smownerid=".$current_user->id." ";
include/utils/UserInfoUtil.php:3781:		$shared_ids = getSharedCalendarId($current_user->id);
include/utils/UserInfoUtil.php:3786:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) $condition or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%')";
include/utils/UserInfoUtil.php:3796:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")";
include/utils/UserInfoUtil.php:3805:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:3810:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or (";
include/utils/UserInfoUtil.php:3816:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3821:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")";
include/utils/UserInfoUtil.php:3830:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3835:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")";
include/utils/UserInfoUtil.php:3844:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:3850:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or ((";
include/utils/UserInfoUtil.php:3856:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:3863:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or ((";
include/utils/UserInfoUtil.php:3869:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:3875:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) " .
include/utils/UserInfoUtil.php:3877:				"or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")";
include/utils/UserInfoUtil.php:3885:		$sec_query .= " vtiger_groups.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3911:        	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:3912:        	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:3917:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or (";
include/utils/UserInfoUtil.php:3923:                         $sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3927:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or (";
include/utils/UserInfoUtil.php:3933:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3938:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or (";
include/utils/UserInfoUtil.php:3944:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3949:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or vtiger_potential.related_to in (select crmid from vtiger_crmentity where setype in ('Accounts', 'Contacts') and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid in (".getTabid('Accounts').", ".getTabid('Contacts').") and relatedtabid=".$tabid.")) ";
include/utils/UserInfoUtil.php:3952:				"or vtiger_potential.related_to in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Accounts' and vtiger_groups.groupid in (select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid.")) ";
include/utils/UserInfoUtil.php:3955:				"or vtiger_potential.related_to in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Contacts' and vtiger_groups.groupid in (select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Contacts')." and relatedtabid=".$tabid.")) ";
include/utils/UserInfoUtil.php:3961:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3966:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") ";
include/utils/UserInfoUtil.php:3969:				"or vtiger_troubletickets.parent_id in (select crmid from vtiger_crmentity where setype='Accounts' and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid.")) or vtiger_troubletickets.parent_id in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Accounts' and vtiger_groups.groupid in(select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid.")) ";
include/utils/UserInfoUtil.php:3977:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:3983:		$shared_ids = getSharedCalendarId($current_user->id);
include/utils/UserInfoUtil.php:3988:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) $condition or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%')";
include/utils/UserInfoUtil.php:3998:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")";
include/utils/UserInfoUtil.php:4002:		 $sec_query .= " or vtiger_quotes.accountid in (select crmid from vtiger_crmentity where setype='Accounts' and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid.")) or vtiger_quotes.accountid in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Accounts' and vtiger_groups.groupid in(select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid."))";
include/utils/UserInfoUtil.php:4006:		 $sec_query .= " or vtiger_quotes.potentialid in (select crmid from vtiger_crmentity where setype='Potentials' and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Potentials')." and relatedtabid=".$tabid.")) or vtiger_quotes.potentialid in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Potentials' and vtiger_groups.groupid in(select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Potentials')." and relatedtabid=".$tabid."))";
include/utils/UserInfoUtil.php:4016:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:4021:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or (";
include/utils/UserInfoUtil.php:4027:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:4032:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")";
include/utils/UserInfoUtil.php:4036:			$sec_query .= " or vtiger_salesorder.accountid in (select crmid from vtiger_crmentity where setype='Accounts' and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid.")) or vtiger_salesorder.accountid in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Accounts' and vtiger_groups.groupid in(select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid."))";
include/utils/UserInfoUtil.php:4040:			$sec_query .= " or vtiger_salesorder.potentialid in (select crmid from vtiger_crmentity where setype='Potentials' and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Potentials')." and relatedtabid=".$tabid.")) or vtiger_salesorder.potentialid in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Potentials' and vtiger_groups.groupid in(select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Potentials')." and relatedtabid=".$tabid."))";
include/utils/UserInfoUtil.php:4044:			$sec_query .= " or vtiger_salesorder.quoteid in (select crmid from vtiger_crmentity where setype='Quotes' and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Quotes')." and relatedtabid=".$tabid.")) or vtiger_salesorder.quoteid in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Quotes' and vtiger_groups.groupid in(select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Quotes')." and relatedtabid=".$tabid."))";
include/utils/UserInfoUtil.php:4054:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid."))) ";
include/utils/UserInfoUtil.php:4059:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")";
include/utils/UserInfoUtil.php:4063:			$sec_query .= " or vtiger_invoice.accountid in (select crmid from vtiger_crmentity where setype='Accounts' and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid.")) or vtiger_invoice.accountid in (select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='Accounts' and vtiger_groups.groupid in(select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('Accounts')." and relatedtabid=".$tabid."))";
include/utils/UserInfoUtil.php:4067:			$sec_query .= " or vtiger_invoice.salesorderid in (select crmid from vtiger_crmentity where setype='SalesOrder' and vtiger_crmentity.smownerid in(select shareduserid from vtiger_tmp_read_user_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('SalesOrder')." and relatedtabid=".$tabid.")) or vtiger_invoice.salesorderid in(select crmid from vtiger_crmentity inner join vtiger_groups on vtiger_groups.groupid=vtiger_crmentity.smownerid where setype='SalesOrder' and vtiger_groups.groupid in(select vtiger_tmp_read_group_rel_sharing_per.sharedgroupid from vtiger_tmp_read_group_rel_sharing_per where userid=".$current_user->id." and tabid=".getTabid('SalesOrder')." and relatedtabid=".$tabid."))";
include/utils/UserInfoUtil.php:4077:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:4083:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or ((";
include/utils/UserInfoUtil.php:4089:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:4096:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or ((";
include/utils/UserInfoUtil.php:4102:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:4108:		$sec_query .= " and (vtiger_crmentity$module.smownerid in($current_user->id) or vtiger_crmentity$module.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%') or vtiger_crmentity$module.smownerid in(select shareduserid from vtiger_tmp_read_user_sharing_per where userid=".$current_user->id." and tabid=".$tabid.") or ((";
include/utils/UserInfoUtil.php:4114:		$sec_query .= " vtiger_groups$module.groupid in(select vtiger_tmp_read_group_sharing_per.sharedgroupid from vtiger_tmp_read_group_sharing_per where userid=".$current_user->id." and tabid=".$tabid.")))) ";
include/utils/UserInfoUtil.php:4316:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:4356:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/UserInfoUtil.php:4438:	$result=$adb->pquery($query, array($recordId, $current_user->id));
include/utils/utils.php:180:	if(isset($current_user) && $current_user->id != '')
include/utils/utils.php:182:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/utils.php:183:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/utils.php:207:					$params = array($current_user->id, $current_user_parent_role_seq."::%", $current_user->id, getTabid($module));
include/utils/utils.php:249:	if(isset($current_user) && $current_user->id != '')
include/utils/utils.php:251:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/utils.php:252:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/utils.php:270:			$params = array( $current_user->id);
include/utils/utils.php:286:			array_push($params, $current_user->id);
include/utils/utils.php:2182:		$form_field .='<font size="1"><em old="ntc_date_format">('.$current_user->date_format.')</em></font><br>';
include/utils/utils.php:2196:		$form_field.='<input name="time_start" id="task_time_start" tabindex="1" type="text" size="5" maxlength="5" type="text" value="'.$default_time_start.'"><br><font size="1"><em old="ntc_date_format">('.$current_user->date_format.')</em></font>&nbsp<font size="1"><em>'.$ntc_time_format.'</em></font></td>';
include/utils/utils.php:2207:		$form_field.='<input name="time_start" id="event_time_start" tabindex="1" type="text" size="5" maxlength="5" type="text" value="'.$default_time_start.'"><br><font size="1"><em old="ntc_date_format">('.$current_user->date_format.')</em></font>&nbsp<font size="1"><em>'.$ntc_time_format.'</em></font></td>';
include/utils/utils.php:2219:		$form_field.='<input name="time_start" type="text" size="5" maxlength="5" type="text" value="'.$default_time_start.'"><br><font size="1"><em old="ntc_date_format">('.$current_user->date_format.')</em></font>&nbsp<font size="1"><em>'.$ntc_time_format.'</em></font></td>';
include/utils/utils.php:2915:	return $adb->query_result($adb->pquery("select int_mailer from vtiger_mail_accounts where user_id=?", array($current_user->id)),0,"int_mailer");
include/utils/utils.php:3140:	$roleid = $current_user->roleid;
include/utils/utils.php:3281:		if(getFieldVisibilityPermission($module,$current_user->id,$fld_name, 'readwrite') == '0') {
include/utils/utils.php:3939:	$fieldname_result = $adb->pquery($fieldname_query, array($tabid, $current_user->id, 1));
include/utils/utils.php:3953:		if(getFieldVisibilityPermission($module,$current_user->id,$field_name) == 0)
include/utils/utils.php:3984:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
include/utils/utils.php:3985:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
include/utils/utils.php:3993:				$sec_parameter .= " AND (vtiger_crmentity.smownerid IN (".$current_user->id.")
include/utils/utils.php:4005:						WHERE userid=".$current_user->id."
include/utils/utils.php:4022:					WHERE userid=".$current_user->id."
include/utils/utils.php:4051:	$current_user->retrieve_entity_info($current_user->id,"Users");
include/utils/VTCacheUtils.php:116:		if(isset($current_user) && $current_user->id == $userid) {
include/utils/VTCacheUtils.php:118:				'currencyid' => $current_user->column_fields['currency_id']
index.php:491:	//$result = $current_user->retrieve($_SESSION['authenticated_user_id']);
index.php:493:	$result = $current_user->retrieveCurrentUserInfoFromFile($_SESSION['authenticated_user_id']);
index.php:531:			$qparams = array($adb->getUniqueID('vtiger_audit_trial'), $current_user->id, $module, $action, $auditrecord, $date_var);
index.php:536:	$log->debug('Current user is: '.$current_user->user_name);
index.php:545:	if(!empty($current_user->theme)) {
index.php:546:		$theme = $current_user->theme;
index.php:563:	if(!empty($current_user->language)) {
index.php:564:		$current_language = $current_user->language;
index.php:597:	if(isset($_REQUEST['record']) && $_REQUEST['record']!='' && $_REQUEST["module"] != "Webmails" && $current_user->id != '')
index.php:600:                $focus->track_view($current_user->id, $currentModule,$_REQUEST['record']);
index.php:606:$current_user->isSupreme = 0;
index.php:608:if(in_array($current_user->user_name,$supremeAdmins)){
index.php:609:	$current_user->isSupreme = 1;
index.php:692:	if(!empty($current_user->theme)) {
index.php:693:		$theme = $current_user->theme;
index.php:701:$seclog->debug('########  Module -->  '.$module.'  :: Action --> '.$action.' ::  UserID --> '.$current_user->id.' :: RecordID --> '.$record.' #######');
index.php:847:		if($currentModule == 'Users' && empty($current_user->id)) {
index.php:879:			var userDateFormat = "<?php echo $current_user->date_format ?>";
index.php:881:			var userCurrencySeparator = "<?php if(isset($current_user->currency_grouping_separator)
index.php:882:													&& $current_user->currency_grouping_separator == '') {
index.php:885:													echo html_entity_decode($current_user->currency_grouping_separator, ENT_QUOTES, $default_charset);
index.php:888:			var userDecimalSeparator = "<?php if(isset($current_user->currency_decimal_separator)
index.php:889:													&& $current_user->currency_decimal_separator == '') {
index.php:892:													echo html_entity_decode($current_user->currency_decimal_separator, ENT_QUOTES, $default_charset);
index.php:901:		if($current_user->id!=NULL && isPermitted('Calendar','index') == 'yes' &&
modules/Accounts/Accounts.php:193:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'account_id','readwrite') == '0') {
modules/Accounts/Accounts.php:328:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Accounts/Accounts.php:333:				if(getFieldVisibilityPermission('Events',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Accounts/Accounts.php:514:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'account_id','readwrite') == '0') {
modules/Accounts/Accounts.php:580:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'account_id','readwrite') == '0') {
modules/Accounts/Accounts.php:647:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'account_id','readwrite') == '0') {
modules/Accounts/Accounts.php:713:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'parent_id','readwrite') == '0') {
modules/Accounts/Accounts.php:866:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Accounts/Accounts.php:989:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Accounts/Accounts.php:996:			if(getFieldVisibilityPermission('Accounts', $current_user->id, $colname) == '0') {
modules/Accounts/Accounts.php:1020:				} else if(getFieldVisibilityPermission('Accounts', $current_user->id, $colname) == '0') {
modules/Accounts/DetailView.php:117:	require("user_privileges/user_privileges_".$current_user->id.".php");	
modules/Accounts/DetailView.php:157:$smarty->assign("USE_ASTERISK", get_use_asterisk($current_user->id));
modules/Accounts/DetailView.php:177:$focus->markAsViewed($current_user->id);
modules/Accounts/ListViewTop.php:40:    require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Accounts/ListViewTop.php:41:    require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Accounts/ListViewTop.php:49:	$list_query .= " AND vtiger_crmentity.smownerid='".$current_user->id."' ".
modules/Accounts/ListViewTop.php:83:	$currencyid=fetchCurrency($current_user->id);
modules/Accounts/Merge.php:104:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Accounts/Save.php:58:$currencyid=fetchCurrency($current_user->id);
modules/AccountsPayable/AccountsPayable.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/AccountsPayable/AccountsPayable.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/AccountsPayable/AccountsPayable.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/AccountsPayable/AccountsPayable.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/AccountsPayable/AccountsPayable.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/AccountsPayable/AccountsPayable.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/AccountsPayable/AccountsPayable.php:289:		if($record_user != $current_user->id){
modules/AccountsPayable/AccountsPayable.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AccountsPayable/AccountsPayable.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AccountsPayable/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/AccountsPayable/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/AccountsPayable/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/AccountsPayable/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/AccountsPayable/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/AccountsPayable/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/AccountsPayable/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/AccountsPayable/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/AccountsPayable/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AccountsPayable/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AccountsReceivable/AccountsReceivable.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/AccountsReceivable/AccountsReceivable.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/AccountsReceivable/AccountsReceivable.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/AccountsReceivable/AccountsReceivable.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/AccountsReceivable/AccountsReceivable.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/AccountsReceivable/AccountsReceivable.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/AccountsReceivable/AccountsReceivable.php:289:		if($record_user != $current_user->id){
modules/AccountsReceivable/AccountsReceivable.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AccountsReceivable/AccountsReceivable.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AccountsReceivable/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/AccountsReceivable/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/AccountsReceivable/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/AccountsReceivable/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/AccountsReceivable/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/AccountsReceivable/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/AccountsReceivable/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/AccountsReceivable/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/AccountsReceivable/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AccountsReceivable/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AdminCost/AdminCost.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/AdminCost/AdminCost.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/AdminCost/AdminCost.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/AdminCost/AdminCost.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/AdminCost/AdminCost.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/AdminCost/AdminCost.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/AdminCost/AdminCost.php:289:		if($record_user != $current_user->id){
modules/AdminCost/AdminCost.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AdminCost/AdminCost.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AdminCost/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/AdminCost/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/AdminCost/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/AdminCost/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/AdminCost/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/AdminCost/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/AdminCost/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/AdminCost/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/AdminCost/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/AdminCost/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/APChecks/APChecks.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/APChecks/APChecks.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/APChecks/APChecks.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/APChecks/APChecks.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/APChecks/APChecks.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/APChecks/APChecks.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/APChecks/APChecks.php:289:		if($record_user != $current_user->id){
modules/APChecks/APChecks.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/APChecks/APChecks.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/APChecks/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/APChecks/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/APChecks/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/APChecks/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/APChecks/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/APChecks/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/APChecks/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/APChecks/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/APChecks/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/APChecks/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ARChecks/ARChecks.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ARChecks/ARChecks.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ARChecks/ARChecks.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/ARChecks/ARChecks.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ARChecks/ARChecks.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ARChecks/ARChecks.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/ARChecks/ARChecks.php:289:		if($record_user != $current_user->id){
modules/ARChecks/ARChecks.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ARChecks/ARChecks.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ARChecks/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/ARChecks/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ARChecks/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ARChecks/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/ARChecks/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ARChecks/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ARChecks/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/ARChecks/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/ARChecks/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ARChecks/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Assets/Assets.php:173:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Assets/Assets.php:174:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Assets/Assets.php:182:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN
modules/Assets/Assets.php:192:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Assets/Assets.php:205:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Assets/Assets.php:244:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Assets/Assets.php:245:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Assets/CallRelatedList.php:32:		$service_base_currency = fetchCurrency($current_user->id);
modules/Assets/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/Assets/Save.php:23:$currencyid=fetchCurrency($current_user->id);
modules/Calendar/Activity.php:735:		$current_user->retrieve_entity_info($user_id, 'Users');
modules/Calendar/Activity.php:736:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/Activity.php:737:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Calendar/Activity.php:793:		$current_user->retrieve_entity_info($user_id, 'Users');
modules/Calendar/Activity.php:794:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/Activity.php:795:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Calendar/ActivityAjax.php:61:		if($current_user->hour_format != '')
modules/Calendar/ActivityAjax.php:62:		        $calendar_arr['calendar']->hour_format=$current_user->hour_format;
modules/Calendar/ActivityAjax.php:111:			if($current_user->hour_format != '')
modules/Calendar/ActivityAjax.php:112:			        $calendar_arr['calendar']->hour_format=$current_user->hour_format;
modules/Calendar/ActivityReminderCallbackAjax.php:39:	$active = $adb->pquery("select * from vtiger_users where id=?",array($current_user->id));
modules/Calendar/ActivityReminderCallbackAjax.php:56:		" and vtiger_crmentity.smownerid = ".$current_user->id." and vtiger_crmentity.deleted = 0 " .
modules/Calendar/ActivityReminderCallbackAjax.php:134:			" and vtiger_crmentity.smownerid = ".$current_user->id." and vtiger_crmentity.deleted = 0 ".
modules/Calendar/addEventUI.php:23: $userDetails=getOtherUserName($current_user->id,true);
modules/Calendar/addEventUI.php:24: $to_email = getUserEmailId('id',$current_user->id);
modules/Calendar/addEventUI.php:32:	if($current_user->activity_view == "This Year"){
modules/Calendar/addEventUI.php:34:	}else if($current_user->activity_view == "This Month"){
modules/Calendar/addEventUI.php:36:	}else if($current_user->activity_view == "This Week"){
modules/Calendar/addEventUI.php:85:if($current_user->hour_format == '')
modules/Calendar/addEventUI.php:88:	$calendar_arr['calendar']->hour_format = $current_user->hour_format;
modules/Calendar/addEventUI.php:233:			<?php if(getFieldVisibilityPermission('Events',$current_user->id,'visibility', 'readwrite') == '0') { ?>	
modules/Calendar/addEventUI.php:238:			<?php if(getFieldVisibilityPermission('Events',$current_user->id,'description', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:244:			<?php if(getFieldVisibilityPermission('Events',$current_user->id,'location', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:254:						<?php if(getFieldVisibilityPermission('Events',$current_user->id,'eventstatus', 'readwrite') == '0')	{ ?>
modules/Calendar/addEventUI.php:257:						<?php if(getFieldVisibilityPermission('Events',$current_user->id,'assigned_user_id', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:262:						<?php if(getFieldVisibilityPermission('Events',$current_user->id,'eventstatus', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:266:							<?php if(getFieldVisibilityPermission('Events',$current_user->id,'assigned_user_id', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:269:								?><input name="assigned_user_id" value="<?php echo $current_user->id ?>" type="hidden">
modules/Calendar/addEventUI.php:272:								<?php if(getFieldVisibilityPermission('Events',$current_user->id,'sendnotification', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:277:					<?php if(getFieldVisibilityPermission('Events',$current_user->id,'taskpriority', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:394:					<?php if(getFieldVisibilityPermission('Events',$current_user->id,'reminder_time', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:397:					<?php } if(getFieldVisibilityPermission('Events',$current_user->id,'recurringtype', 'readwrite') == '0') {  ?>
modules/Calendar/addEventUI.php:464:				<?php if(getFieldVisibilityPermission('Events',$current_user->id,'reminder_time', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:534:			<?php if(getFieldVisibilityPermission('Events',$current_user->id,'recurringtype', 'readwrite') == '0') {  ?>
modules/Calendar/addEventUI.php:645:				<?php if(getFieldVisibilityPermission('Events',$current_user->id,'parent_id', 'readwrite') == '0') {  ?>
modules/Calendar/addEventUI.php:668:					<?php if(getFieldVisibilityPermission('Events',$current_user->id,'contact_id', 'readwrite') == '0') { ?>	
modules/Calendar/addEventUI.php:714:					<?php if(getFieldVisibilityPermission('Events',$current_user->id,'eventstatus', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:740:	if($current_user->column_fields['is_admin']=='on')
modules/Calendar/addEventUI.php:744:		$role_id=$current_user->roleid;
modules/Calendar/addEventUI.php:804:		<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'description', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:815:							<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'taskstatus', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:820:							<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'taskpriority', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:825:							<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'assigned_user_id', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:832:							<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'taskstatus', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:837:							<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'taskpriority', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:842:							<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'assigned_user_id', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:845:						       	?><input name="task_assigned_user_id" value="<?php echo $current_user->id ?>" type="hidden">
modules/Calendar/addEventUI.php:926:	<?php if((getFieldVisibilityPermission('Calendar',$current_user->id,'sendnotification', 'readwrite') == '0') || (getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') || (getFieldVisibilityPermission('Calendar',$current_user->id,'contact_id', 'readwrite') == '0')) { ?>
modules/Calendar/addEventUI.php:933:						<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'sendnotification', 'readwrite') == '0') { $classval = "dvtUnSelectedCell";  ?>
modules/Calendar/addEventUI.php:937:						<?php if((getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') || (getFieldVisibilityPermission('Calendar',$current_user->id,'contact_id', 'readwrite') == '0')) { ?>
modules/Calendar/addEventUI.php:949:		<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'sendnotification', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:959:			<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') { ?>
modules/Calendar/addEventUI.php:986:			<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'contact_id', 'readwrite') == '0') { ?>	
modules/Calendar/addEventUI.php:1082:					<?php if(getFieldVisibilityPermission('Calendar',$current_user->id,'taskstatus', 'readwrite') == '0') { ?>
modules/Calendar/Appointment.php:64:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/Appointment.php:65:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Calendar/Appointment.php:157:						list($obj->temphour,$obj->tempmin)= $current_user->start_hour !=''?explode(":",$current_user->start_hour):explode(":","08:00");
modules/Calendar/Appointment.php:160:						list($obj->temphour,$obj->tempmin)= $current_user->start_hour !=''?explode(":",$current_user->start_hour):explode(":","08:00");
modules/Calendar/Appointment.php:227:			if($act_array["smownerid"]!=0 && $act_array["smownerid"] != $current_user->id && $act_array["visibility"] == "Public"){
modules/Calendar/Appointment.php:229:				$row = $adb->pquery($que, array($current_user->id, $act_array["smownerid"]));
modules/Calendar/Appointment.php:306:	$is_Admin = $current_user->is_admin;
modules/Calendar/Appointment.php:309:				$roleid=$current_user->roleid;
modules/Calendar/Calendar.php:170:		if(isset($current_user->start_hour) && $current_user->start_hour !='')
modules/Calendar/Calendar.php:172:			list($sthour,$stmin)= explode(":",$current_user->start_hour);
modules/Calendar/Calendar.php:180:		if(isset($current_user->end_hour) && $current_user->end_hour !='')
modules/Calendar/Calendar.php:182:			list($endhour,$endmin)=explode(":",$current_user->end_hour);
modules/Calendar/Calendar.php:205:		$activities = Appointment::readAppointment($current_user->id,$start_datetime,$end_datetime,$this->view);
modules/Calendar/calendar_share.php:17: $userDetails=getSharingUserName($current_user->id);
modules/Calendar/calendar_share.php:18: $shareduser_ids = getSharedUserId($current_user->id);
modules/Calendar/calendar_share.php:39:<input type="hidden" name="current_userid" value="<?php echo $current_user->id ?>" >
modules/Calendar/calendar_share.php:50:			<input type="checkbox" name="sttime_check" <?php if($current_user->start_hour != ''){?> checked <?php } ?> onClick="enableCalstarttime();">&nbsp;<?php echo $mod_strings['LBL_CALSTART']?> 
modules/Calendar/calendar_share.php:51:			<select name="start_hour" <?php if($current_user->start_hour == ''){?>disabled <?php } ?> >
modules/Calendar/calendar_share.php:75:							if($value === $current_user->start_hour)
modules/Calendar/calendar_share.php:85:			<input type="checkbox" name="hour_format" <?php if($current_user->hour_format == '24'){?> checked <?php } ?> value="24">&nbsp;<?php echo $mod_strings['LBL_USE24']?>
modules/Calendar/CalendarCommon.php:87:	$assigned_user_id = $current_user->id;
modules/Calendar/CalendarCommon.php:88:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Calendar/CalendarCommon.php:89:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/CalendarCommon.php:94:		$params = array($current_user->id, $role_seq."::%", $current_user->id);
modules/Calendar/CalendarCommon.php:237:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/CalendarCommon.php:247:		$roleid=$current_user->roleid;
modules/Calendar/CalendarCommon.php:284:	$assigned_user_id = $current_user->id;
modules/Calendar/CalendarCommon.php:285:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Calendar/CalendarCommon.php:286:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/CalendarCommon.php:352:	$current_username = getUserFullName($current_user->id);
modules/Calendar/CalendarCommon.php:434:			send_mail('Calendar',$to_email,$current_user->user_name,'',$subject,$description);
modules/Calendar/CalendarCommon.php:529:	if($only_for_user == '') $only_for_user = $current_user->id;
modules/Calendar/CalendarCommon.php:540:			if($only_for_user == $current_user->id) {
modules/Calendar/CalendarCommon.php:541:				$user_group_ids = fetchUserGroupids($current_user->id);
modules/Calendar/CalendarCommon.php:545:				$user_group_ids .= $current_user->id;	
modules/Calendar/CalendarCommon.php:573:	$userSelectdata .= "<option value='$current_user->id'".(($current_user->id == $useridInUse)? "selected='true'":"").">".$mod_strings['LBL_MINE']."</option>";	
modules/Calendar/CalendarCommon.php:577:		if($userid == $current_user->id) {
modules/Calendar/calendarLayout.php:262:        $date_format = $current_user->date_format;
modules/Calendar/calendarLayout.php:272:	if($current_user->column_fields['is_admin']=='on')
modules/Calendar/calendarLayout.php:276:		$roleid=$current_user->roleid;
modules/Calendar/calendarLayout.php:706:        $date_format = $current_user->date_format;
modules/Calendar/calendarLayout.php:775:        $date_format = $current_user->date_format;
modules/Calendar/calendarLayout.php:870:	$date_format = $current_user->date_format;
modules/Calendar/calendarLayout.php:1138:			$role_list = $adb->pquery("SELECT * from vtiger_role WHERE parentrole LIKE '". formatForSqlLike($current_user->column_fields['roleid']) . formatForSqlLike($assigned_role_id) ."'",array());
modules/Calendar/calendarLayout.php:1139:			$is_shared = $adb->pquery("SELECT * from vtiger_sharedcalendar where userid=? and sharedid=?",array($userid,$current_user->id));
modules/Calendar/calendarLayout.php:1140:			$userName = getFullNameFromArray('Users', $current_user->column_fields);
modules/Calendar/calendarLayout.php:1141:			if(($current_user->column_fields['is_admin']!='on' && $adb->num_rows($role_list)==0 && (($adb->num_rows($is_shared)==0 && ($visibility=='Public' || $visibility=='Private')) || $visibility=='Private')) && $userName!=$user)
modules/Calendar/calendarLayout.php:1154:			if(($current_user->column_fields['is_admin']!='on' && $adb->num_rows($role_list)==0 && (($adb->num_rows($is_shared)==0 && ($visibility=='Public' || $visibility=='Private')) || $visibility=='Private')) && $userName!=$user)
modules/Calendar/calendarLayout.php:1236:			$role_list = $adb->pquery("SELECT * from vtiger_role WHERE parentrole LIKE '". formatForSqlLike($current_user->column_fields['roleid']) . formatForSqlLike($assigned_role_id) ."'",array());
modules/Calendar/calendarLayout.php:1237:			$is_shared = $adb->pquery("SELECT * from vtiger_sharedcalendar where userid=? and sharedid=?",array($userid,$current_user->id));
modules/Calendar/calendarLayout.php:1238:			$userName = getFullNameFromArray('Users', $current_user->column_fields);
modules/Calendar/calendarLayout.php:1239:			if(($current_user->column_fields['is_admin']!='on' && $adb->num_rows($role_list)==0 && (($adb->num_rows($is_shared)==0 && ($visibility=='Public' || $visibility=='Private')) || $visibility=='Private')) && $userName!=$user)
modules/Calendar/calendarLayout.php:1254:					if(($current_user->column_fields['is_admin']!='on' && $adb->num_rows($role_list)==0 && (($adb->num_rows($is_shared)==0 && ($visibility=='Public' || $visibility=='Private')) || $visibility=='Private')) && $userName!=$user)
modules/Calendar/calendarLayout.php:1323:						$role_list = $adb->pquery("SELECT * from vtiger_role WHERE parentrole LIKE '". formatForSqlLike($current_user->column_fields['roleid']) . formatForSqlLike($assinged_role_id) ."'",array());
modules/Calendar/calendarLayout.php:1324:						$is_shared = $adb->pquery("SELECT * from vtiger_sharedcalendar where userid=? and sharedid=?",array($userid,$current_user->id));
modules/Calendar/calendarLayout.php:1326:						if(($current_user->column_fields['is_admin']!='on' && $adb->num_rows($role_list)==0 && (($adb->num_rows($is_shared)==0 && ($visibility=='Public' || $visibility=='Private')) || $visibility=='Private')) && $current_user->id != $userid)
modules/Calendar/calendarLayout.php:1363:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/calendarLayout.php:1364:        require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Calendar/calendarLayout.php:1400:        $list_query = $query." AND vtiger_crmentity.smownerid = "  . $current_user->id;
modules/Calendar/calendarLayout.php:1420:		$groupids = explode(",", fetchUserGroupids($current_user->id)); // Explode can be removed, once implode is removed from fetchUserGroupids
modules/Calendar/calendarLayout.php:1433:		array_push($info_params, $current_user->id);
modules/Calendar/calendarLayout.php:1532:		if(!empty($assignedto) && $userid != $current_user->id && $adb->query_result($result,$i,"visibility") == "Public")
modules/Calendar/calendarLayout.php:1535:			$row = $adb->pquery($que, array($current_user->id, $userid));
modules/Calendar/calendarLayout.php:1564:		/*if(getFieldVisibilityPermission('Events',$current_user->id,'parent_id') == '0')
modules/Calendar/calendarLayout.php:1578:		if(getFieldVisibilityPermission('Events',$current_user->id,'eventstatus') == '0')
modules/Calendar/calendarLayout.php:1582:				$roleid=$current_user->roleid;
modules/Calendar/calendarLayout.php:1637:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/calendarLayout.php:1638:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Calendar/calendarLayout.php:1659:	$list_query = $query." AND vtiger_crmentity.smownerid = "  . $current_user->id;
modules/Calendar/calendarLayout.php:1670:			$groupids = explode(",", fetchUserGroupids($current_user->id));
modules/Calendar/calendarLayout.php:1674:				array_push($info_params, $current_user->id);
modules/Calendar/calendarLayout.php:1678:				array_push($info_params, $current_user->id);
modules/Calendar/calendarLayout.php:1762:		if(getFieldVisibilityPermission('Calendar',$current_user->id,'taskstatus') == '0')
modules/Calendar/calendarLayout.php:1768:				$roleid=$current_user->roleid;
modules/Calendar/calendarLayout.php:1859:	$date_format = $current_user->date_format;
modules/Calendar/calendarLayout.php:1896:	if(getFieldVisibilityPermission('Events',$current_user->id,'eventstatus') == '0')
modules/Calendar/calendarLayout.php:1921:		$userName = getFullNameFromArray('Users', $current_user->column_fields);
modules/Calendar/calendarLayout.php:1935:			$role_list = $adb->pquery("SELECT * from vtiger_role WHERE parentrole LIKE '". formatForSqlLike($current_user->column_fields['roleid']) . formatForSqlLike($assigned_user_role_id) ."'",array());
modules/Calendar/calendarLayout.php:1936:			$is_shared = $adb->pquery("SELECT * from vtiger_sharedcalendar where userid=? and sharedid=?",array($assigned_user_id,$current_user->id));
modules/Calendar/calendarLayout.php:1941:						&& ($current_user->column_fields['is_admin']!='on'
modules/Calendar/calendarLayout.php:2001:        $date_format = $current_user->date_format;
modules/Calendar/calendarLayout.php:2027:		if(getFieldVisibilityPermission('Calendar',$current_user->id,'taskstatus') == '0')
modules/Calendar/calendarLayout.php:2056:		if(getFieldVisibilityPermission('Calendar',$current_user->id,'taskstatus') == '0')
modules/Calendar/calendarLayout.php:2069:	if($current_user->column_fields['is_admin']=='on')
modules/Calendar/calendarLayout.php:2073:		$roleid=$current_user->roleid;
modules/Calendar/calendarLayout.php:2185:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Calendar/calendarLayout.php:2186:        require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Calendar/calendarLayout.php:2189:		$shared_ids = getSharedCalendarId($current_user->id);
modules/Calendar/calendarLayout.php:2191:			$condition = " or (vtiger_crmentity.smownerid in($shared_ids)) or (vtiger_crmentity.smownerid NOT LIKE ($current_user->id))";// and vtiger_activity.visibility = 'Public')";
modules/Calendar/calendarLayout.php:2193:			$condition = "or (vtiger_crmentity.smownerid NOT LIKE ($current_user->id))";
modules/Calendar/calendarLayout.php:2194:		$sec_query .= " and (vtiger_crmentity.smownerid in($current_user->id) $condition or vtiger_crmentity.smownerid in(select vtiger_user2role.userid from vtiger_user2role inner join vtiger_users on vtiger_users.id=vtiger_user2role.userid inner join vtiger_role on vtiger_role.roleid=vtiger_user2role.roleid where vtiger_role.parentrole like '".$current_user_parent_role_seq."::%')";
modules/Calendar/DetailView.php:132:if($current_user->hour_format == '')
modules/Calendar/DetailView.php:135:	$format = $current_user->hour_format;
modules/Calendar/DetailView.php:233:	$is_fname_permitted = getFieldVisibilityPermission("Contacts", $current_user->id, 'firstname');
modules/Calendar/EditView.php:146:$userDetails=getOtherUserName($current_user->id);
modules/Calendar/EditView.php:147:$to_email = getUserEmailId('id',$current_user->id);
modules/Calendar/EditView.php:148:$smarty->assign("CURRENTUSERID",$current_user->id);
modules/Calendar/EditView.php:184:$format = ($current_user->hour_format == '')?'am/pm':$current_user->hour_format;
modules/Calendar/EditView.php:240:$isContactIdEditable = getFieldVisibilityPermission($tab_type, $current_user->id, 'contact_id', 'readwrite');
modules/Calendar/iCal/iCalendar_components.php:238:						if(getFieldVisibilityPermission($modtype,$current_user->id,$this->field_mapping_arr[$component])=='0')
modules/Calendar/iCal/iCalendar_components.php:243:						if(getFieldVisibilityPermission($modtype,$current_user->id,$component)=='0')
modules/Calendar/iCal/iCalendar_components.php:260:							if(getFieldVisibilityPermission($modtype,$current_user->id,$this->field_mapping_arr[$index])=='0')
modules/Calendar/iCal/iCalendar_components.php:265:							if(getFieldVisibilityPermission($modtype,$current_user->id,$index)=='0')
modules/Calendar/iCalExport.php:19:	" where vtiger_crmentity.deleted = 0 and vtiger_crmentity.smownerid = " . $current_user->id . 
modules/Calendar/iCalExport.php:40:	if(getFieldVisibilityPermission('Calendar',$current_user->id,$key)==0){
modules/Calendar/iCalExport.php:49:	if(getFieldVisibilityPermission('Events',$current_user->id,$key)==0){
modules/Calendar/iCalImport.php:19:	$last_import->clearRecords($current_user->id);
modules/Calendar/iCalImport.php:56:		$calendar->column_fields['assigned_user_id'] = $current_user->id;
modules/Calendar/iCalImport.php:70:		$last_import->setFields(array('userid' => $current_user->id,
modules/Calendar/iCalImport.php:133:	$ret_value = $last_import->undo('Calendar', $current_user->id);
modules/Calendar/new_calendar.php:31:	if($current_user->activity_view == "This Year"){
modules/Calendar/new_calendar.php:33:	}else if($current_user->activity_view == "This Month"){
modules/Calendar/new_calendar.php:35:	}else if($current_user->activity_view == "This Week"){
modules/Calendar/new_calendar.php:78:if($current_user->hour_format != '') 
modules/Calendar/new_calendar.php:79:	$calendar_arr['calendar']->hour_format=$current_user->hour_format;
modules/Calendar/RepeatEvents.php:38:		switch($current_user->date_format) {
modules/Calendar/updateCalendarSharing.php:37:    $adb->pquery($sql, array($_REQUEST['start_hour'], $current_user->id));
modules/Calendar/updateCalendarSharing.php:41:$adb->pquery($sql, array($hour_format, $current_user->id));
modules/Campaigns/Campaigns.php:109:		if(getFieldVisibilityPermission('Accounts', $current_user->id, 'campaignrelstatus') == '0') {
modules/Campaigns/Campaigns.php:113:			$is_CampaignStatusAllowed = (getFieldVisibilityPermission('Accounts', $current_user->id, 'campaignrelstatus','readwrite') == '0')? true : false;
modules/Campaigns/Campaigns.php:206:		if(getFieldVisibilityPermission('Contacts', $current_user->id, 'campaignrelstatus') == '0') {
modules/Campaigns/Campaigns.php:210:			$is_CampaignStatusAllowed = (getFieldVisibilityPermission('Contacts', $current_user->id, 'campaignrelstatus','readwrite') == '0')? true : false;
modules/Campaigns/Campaigns.php:302:		if(getFieldVisibilityPermission('Leads', $current_user->id, 'campaignrelstatus') == '0') {
modules/Campaigns/Campaigns.php:306:			$is_CampaignStatusAllowed  = (getFieldVisibilityPermission('Leads', $current_user->id, 'campaignrelstatus','readwrite') == '0')? true : false;
modules/Campaigns/Campaigns.php:406:		if($actions && getFieldVisibilityPermission($related_module,$current_user->id,'campaignid', 'readwrite') == '0') {
modules/Campaigns/Campaigns.php:470:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Campaigns/Campaigns.php:475:				if(getFieldVisibilityPermission('Events',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Campaigns/DetailView.php:107:$focus->markAsViewed($current_user->id);
modules/CBR/CBR.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CBR/CBR.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/CBR/CBR.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/CBR/CBR.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/CBR/CBR.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/CBR/CBR.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/CBR/CBR.php:289:		if($record_user != $current_user->id){
modules/CBR/CBR.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/CBR/CBR.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/CBR/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/CBR/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CBR/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/CBR/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/CBR/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/CBR/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/CBR/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/CBR/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/CBR/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/CBR/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Collection/Collection.php:142:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Collection/Collection.php:143:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Collection/Collection.php:151:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Collection/Collection.php:161:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Collection/Collection.php:174:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Collection/Collection.php:252:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Collection/Collection.php:290:		if($record_user != $current_user->id){
modules/Collection/Collection.php:293:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Collection/Collection.php:299:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Collection/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/Collection/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Collection/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Collection/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Collection/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Collection/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Collection/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Collection/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/Collection/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Collection/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/CollectionLogs/CollectionLogs.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CollectionLogs/CollectionLogs.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/CollectionLogs/CollectionLogs.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/CollectionLogs/CollectionLogs.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/CollectionLogs/CollectionLogs.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/CollectionLogs/CollectionLogs.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/CollectionLogs/CollectionLogs.php:289:		if($record_user != $current_user->id){
modules/CollectionLogs/CollectionLogs.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/CollectionLogs/CollectionLogs.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/CollectionLogs/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/CollectionLogs/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CollectionLogs/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/CollectionLogs/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/CollectionLogs/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/CollectionLogs/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/CollectionLogs/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/CollectionLogs/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/CollectionLogs/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/CollectionLogs/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/com_vtiger_workflow/VTWorkflowUtils.php:115:		return strtolower($current_user->is_admin) === 'on';
modules/Contacts/CallRelatedList.php:59:		$userid = $current_user->id;
modules/Contacts/Contacts.php:255:          require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Contacts/Contacts.php:408:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'contact_id', 'readwrite') == '0') {
modules/Contacts/Contacts.php:413:				if(getFieldVisibilityPermission('Events',$current_user->id,'contact_id', 'readwrite') == '0') {
modules/Contacts/Contacts.php:508:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'parent_id', 'readwrite') == '0') {
modules/Contacts/Contacts.php:566:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'contact_id', 'readwrite') == '0') {
modules/Contacts/Contacts.php:615:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'contact_id', 'readwrite') == '0') {
modules/Contacts/Contacts.php:726:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'contact_id', 'readwrite') == '0') {
modules/Contacts/Contacts.php:889:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'contact_id', 'readwrite') == '0') {
modules/Contacts/Contacts.php:982:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Contacts/Contacts.php:1024:	$current_user->retrieve_entity_info($user_id, 'Users');
modules/Contacts/Contacts.php:1025:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Contacts/Contacts.php:1026:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Contacts/Contacts.php:1067:	$current_user->retrieve_entity_info($user_id, 'Users');
modules/Contacts/Contacts.php:1068:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Contacts/Contacts.php:1069:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Contacts/ContactsHandler.php:55:			$mail_status = send_mail('Contacts',$entityData->get('email'),$current_user->user_name,"",$subject,$contents);
modules/Contacts/DetailView.php:73:if (getFieldVisibilityPermission($currentModule, $current_user->id,'firstname') == '0') {
modules/Contacts/DetailView.php:130:        require("user_privileges/user_privileges_".$current_user->id.".php");
modules/Contacts/DetailView.php:168:$smarty->assign("USE_ASTERISK", get_use_asterisk($current_user->id));
modules/Contacts/DetailView.php:197:$focus->markAsViewed($current_user->id);
modules/Contacts/EditView.php:121:if (getFieldVisibilityPermission($currentModule, $current_user->id, 'firstname') == '0') {
modules/Contacts/Merge.php:86:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CustomerPortal/AdvancedSettings.php:15:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CustomerPortal/index.php:12:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CustomerPortal/ListView.php:17:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CustomView/CustomView.php:64:		$this->smownerid = $current_user->id;
modules/CustomView/CustomView.php:99:				$defcv_result = $adb->pquery("select default_cvid from vtiger_user_module_preferences where userid = ? and tabid =?", array($current_user->id, getTabid($module)));
modules/CustomView/CustomView.php:160:		require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/CustomView/CustomView.php:168:			array_push($sparams, $current_user->id);
modules/CustomView/CustomView.php:172:		$usercv_result = $adb->pquery("select default_cvid from vtiger_user_module_preferences where userid = ? and tabid = ?", array($current_user->id, $tabid));
modules/CustomView/CustomView.php:199:		require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/CustomView/CustomView.php:217:			array_push($sparams, $current_user->id);
modules/CustomView/CustomView.php:228:			if ($cvrow['status'] == CV_STATUS_DEFAULT || $cvrow['userid'] == $current_user->id) {
modules/CustomView/CustomView.php:248:				if ($cvrow['status'] == CV_STATUS_DEFAULT || $cvrow['userid'] == $current_user->id) {
modules/CustomView/CustomView.php:286:		require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/CustomView/CustomView.php:452:		require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/CustomView/CustomView.php:1156:							if (getFieldVisibilityPermission("Calendar", $current_user->id, 'taskstatus') == '0') {
modules/CustomView/CustomView.php:1284:				if (getFieldVisibilityPermission("Calendar", $current_user->id, 'taskstatus') == '0') {
modules/CustomView/CustomView.php:1848:		require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/CustomView/CustomView.php:1869:					if ($userid == $current_user->id) {
modules/CustomView/CustomView.php:1870:						$log->debug("Entering when $userid=$current_user->id");
modules/CustomView/CustomView.php:1882:						if ($userid == $current_user->id)
modules/CustomView/CustomView.php:1896:								if (!in_array($current_user->id, $user_array))
modules/CustomView/CustomView.php:1934:		require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/CustomView/EditView.php:42:$smarty->assign("DATEFORMAT",$current_user->date_format);
modules/CustomView/EditView.php:272:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CustomView/EditView.php:325:				if(getFieldVisibilityPermission($module,$current_user->id,$keys[2]) != '0')
modules/CustomView/ListViewTop.php:144:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/CustomView/ListViewTop.php:152:	      array_push($sparams, $current_user->id);
modules/CustomView/Save.php:35:	$userid = $current_user->id;
modules/CustomView/Save.php:106:				$sql_result = $adb->pquery("SELECT * FROM vtiger_user_module_preferences WHERE userid = ? and tabid = ?",array($current_user->id, $cv_tabid));
modules/CustomView/Save.php:109:					$updatedefaultresult = $adb->pquery($updatedefaultsql, array($genCVid, $current_user->id, $cv_tabid));
modules/CustomView/Save.php:115:				$sql_result = $adb->pquery("SELECT * FROM vtiger_user_module_preferences WHERE userid = ? and tabid = ?",array($current_user->id, $cv_tabid));
modules/CustomView/Save.php:118:					$deletedefaultresult = $adb->pquery($deletedefaultsql, array($current_user->id, $cv_tabid));
modules/CustomView/Save.php:211:		if($is_admin == true || $current_user->id) {
modules/CustomView/Save.php:219:				$sql_result = $adb->pquery("SELECT * FROM vtiger_user_module_preferences WHERE userid = ? and tabid = ?",array($current_user->id, $cv_tabid));
modules/CustomView/Save.php:222:					$updatedefaultresult = $adb->pquery($updatedefaultsql, array($cvid, $current_user->id, $cv_tabid));
modules/CustomView/Save.php:228:				$sql_result = $adb->pquery("SELECT * FROM vtiger_user_module_preferences WHERE userid = ? and tabid = ?",array($current_user->id, $cv_tabid));
modules/CustomView/Save.php:231:					$deletedefaultresult = $adb->pquery($deletedefaultsql, array($current_user->id, $cv_tabid));
modules/CustomView/SendMailAction.php:51:						SendMailtoCustomView($camodule,$id,$emailid,$current_user->id,$subject,$contents);
modules/CustomView/SendMailAction.php:54:						SendMailtoCustomView($camodule,$id,$otheremailid,$current_user->id,$subject,$contents);
modules/CustomView/SendMailAction.php:57:						SendMailtoCustomView($camodule,$id,$secondaryemail,$current_user->id,$subject,$contents);
modules/CustomView/SendMailAction.php:77:						SendMailtoCustomView($camodule,$id,$emailid,$current_user->id,$subject,$contents);
modules/CustomView/SendMailAction.php:81:						SendMailtoCustomView($camodule,$id,$secondaryemail,$current_user->id,$subject,$contents);
modules/CustomView/SendMailAction.php:100:						SendMailtoCustomView($camodule,$id,$emailid,$current_user->id,$subject,$contents);
modules/CustomView/SendMailAction.php:104:						SendMailtoCustomView($camodule,$id,$otheremailid,$current_user->id,$subject,$contents);
modules/Dashboard/Chart_lead_source_by_outcome.php:28:require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Dashboard/Chart_lead_source_by_outcome.php:29:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Dashboard/Chart_lead_source_by_outcome.php:54:	$current_user->setPreference('lsbo_lead_sources', $_REQUEST['lsbo_lead_sources']);
modules/Dashboard/Chart_lead_source_by_outcome.php:82:	$current_user->setPreference('lsbo_ids', $_REQUEST['lsbo_ids']);
modules/Dashboard/Chart_lead_source_by_outcome.php:132:	<td valign='top'><select name="lsbo_ids[]" multiple size='3'><?php echo get_select_options_with_id(get_user_array(FALSE, "Active", $current_user->id,'private'),$_SESSION['lsbo_ids']); ?></select></td>
modules/Dashboard/Chart_lead_source_by_outcome.php:134:	<td valign='top' ><select name="lsbo_ids[]" multiple size='3'><?php echo get_select_options_with_id(get_user_array(FALSE, "Active",$current_user->id),$_SESSION['lsbo_ids']); ?></select></td>
modules/Dashboard/Chart_my_pipeline_by_sales_stage.php:51:	$current_user->setPreference('mypbss_date_start', $_REQUEST['mypbss_date_start']);
modules/Dashboard/Chart_my_pipeline_by_sales_stage.php:68:	$current_user->setPreference('mypbss_date_end', $_REQUEST['mypbss_date_end']);
modules/Dashboard/Chart_my_pipeline_by_sales_stage.php:88:	$current_user->setPreference('mypbss_sales_stages', $_REQUEST['mypbss_sales_stages']);
modules/Dashboard/Chart_my_pipeline_by_sales_stage.php:107:$ids = array($current_user->id);
modules/Dashboard/Chart_outcome_by_month.php:26:require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Dashboard/Chart_outcome_by_month.php:27:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Dashboard/Chart_outcome_by_month.php:61:	$current_user->setPreference('obm_date_start', $_REQUEST['obm_date_start']);
modules/Dashboard/Chart_outcome_by_month.php:78:	$current_user->setPreference('obm_date_end', $_REQUEST['obm_date_end']);
modules/Dashboard/Chart_outcome_by_month.php:97:	$current_user->setPreference('obm_ids', $_REQUEST['obm_ids']);
modules/Dashboard/Chart_outcome_by_month.php:159:	<td valign='top' ><select name="obm_ids[]" multiple size='3'><?php echo get_select_options_with_id(get_user_array(FALSE, "Active", $current_user->id,'private'),$_SESSION['obm_ids']); ?></select></td>
modules/Dashboard/Chart_outcome_by_month.php:161:	<td valign='top' ><select name="obm_ids[]" multiple size='3'><?php echo get_select_options_with_id(get_user_array(FALSE, "Active",$current_user->id),$_SESSION['obm_ids']); ?></select></td>
modules/Dashboard/Chart_pipeline_by_lead_source.php:28:require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Dashboard/Chart_pipeline_by_lead_source.php:29:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Dashboard/Chart_pipeline_by_lead_source.php:54:	$current_user->setPreference('pbls_lead_sources', $_REQUEST['pbls_lead_sources']);
modules/Dashboard/Chart_pipeline_by_lead_source.php:82:	$current_user->setPreference('pbls_ids', $ids);
modules/Dashboard/Chart_pipeline_by_lead_source.php:133:	<td valign='top'><select name="pbls_ids[]" multiple size='3'><?php echo get_select_options_with_id(get_user_array(FALSE, "Active", $current_user->id,'private'),$_SESSION['pbls_ids']); ?></select></td>
modules/Dashboard/Chart_pipeline_by_lead_source.php:135:	<td valign='top'><select name="pbls_ids[]" multiple size='3'><?php echo get_select_options_with_id(get_user_array(false, "Active" ,$current_user->id),$_SESSION['pbls_ids']); ?></select></td>
modules/Dashboard/Chart_pipeline_by_sales_stage.php:28:require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Dashboard/Chart_pipeline_by_sales_stage.php:29:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Dashboard/Chart_pipeline_by_sales_stage.php:63:	$current_user->setPreference('pbss_date_start', $_REQUEST['pbss_date_start']);
modules/Dashboard/Chart_pipeline_by_sales_stage.php:80:	$current_user->setPreference('pbss_date_end', $_REQUEST['pbss_date_end']);
modules/Dashboard/Chart_pipeline_by_sales_stage.php:100:	$current_user->setPreference('pbss_sales_stages', $_REQUEST['pbss_sales_stages']);
modules/Dashboard/Chart_pipeline_by_sales_stage.php:128:	$current_user->setPreference('pbss_ids', $_REQUEST['pbss_ids']);
modules/Dashboard/Chart_pipeline_by_sales_stage.php:197:	<td valign='top'><select name="pbss_ids[]" multiple size='3'><?php echo get_select_options_with_id(get_user_array(FALSE, "Active", $current_user->id,'private'),$_SESSION['pbss_ids']); ?></select></td>
modules/Dashboard/Chart_pipeline_by_sales_stage.php:199:	<td valign='top'><select name="pbss_ids[]" multiple size='3'><?php echo get_select_options_with_id(get_user_array(FALSE,"Active",$current_user->id),$_SESSION['pbss_ids']); ?></select></td>	
modules/Dashboard/display_charts.php:18:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Dashboard/display_charts.php:36:$user_id=$current_user->id;
modules/Dashboard/display_charts.php:795:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Dashboard/display_charts.php:796:	$roleid=$current_user->roleid;
modules/Dashboard/Entity_charts.php:435:							if(getFieldVisibilityPermission('Contacts', $current_user->id,
modules/Dashboard/Entity_charts.php:484:						$link_val="index.php?module=".$mod_name."&action=ListView&from_homepagedb=true&type=dbrd&query=true&owner=".$current_user->user_name."&viewname=".$cvid;
modules/Dashboard/HomepageDB.php:12:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Dashboard/HomepageDB.php:31:$homepagedb_query = "select * from vtiger_crmentity se left join vtiger_leaddetails le on le.leadid=se.crmid left join vtiger_troubletickets tt on tt.ticketid=se.crmid left join vtiger_activity act on act.activityid=se.crmid left join vtiger_potential pot on pot.potentialid=se.crmid where se.deleted=0 and (le.converted=0 or le.converted is null) and (pot.sales_stage not in('".$app_strings['LBL_CLOSE_WON']."','".$app_strings['LBL_CLOSE_LOST']."') or pot.sales_stage is null) and (tt.status!='Closed' or tt.status is null) and ((act.status!='Completed' and act.status!='Deferred') or act.status is null) and ((act.eventstatus!='Held' and act.eventstatus!='Not Held') or act.eventstatus is null) and setype in ('".$moduleList."') and se.deleted=0 and se.smownerid=".$current_user->id;
modules/Dashboard/HomepageDB.php:33:$graph_title=$mod_strings['recordsforuser'].' '.$current_user->user_name;
modules/Dashboard/HomepageDB.php:39:$cache_file_name=abs(crc32($current_user->id))."_".$type."_".crc32($date_start.$end_date).".png";
modules/Dashboard/HomepageDB.php:41:$graph_details=module_Chart($current_user->id,$date_start,$end_date,$query,$graph_by,$graph_title,$where,$module,$type);
modules/DAT/DAT.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/DAT/DAT.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/DAT/DAT.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/DAT/DAT.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/DAT/DAT.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/DAT/DAT.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/DAT/DAT.php:289:		if($record_user != $current_user->id){
modules/DAT/DAT.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/DAT/DAT.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/DAT/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/DAT/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/DAT/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/DAT/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/DAT/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/DAT/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/DAT/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/DAT/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/DAT/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/DAT/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Disbursement/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/Disbursement/Disbursement.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Disbursement/Disbursement.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Disbursement/Disbursement.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Disbursement/Disbursement.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Disbursement/Disbursement.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Disbursement/Disbursement.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Disbursement/Disbursement.php:289:		if($record_user != $current_user->id){
modules/Disbursement/Disbursement.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Disbursement/Disbursement.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Disbursement/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Disbursement/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Disbursement/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Disbursement/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Disbursement/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Disbursement/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Disbursement/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/Disbursement/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Disbursement/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Documents/DeleteFolder.php:17:if($current_user->is_admin != 'on')
modules/Documents/DetailView.php:164:$focus->markAsViewed($current_user->id);
modules/Documents/EditView.php:48:			$permitted_users = get_user_array('true', 'Active',$current_user->id);
modules/Documents/EditView.php:50:				$owner['Users'] = $current_user->id;
modules/Documents/EditView.php:127:if(getFieldVisibilityPermission('Documents',$current_user->id,'notecontent') != '0')
modules/Documents/MoveFile.php:14:if($current_user->is_admin != 'on')
modules/Documents/SaveFolder.php:45:				$sql="insert into vtiger_attachmentsfolder (folderid,foldername,description,createdby,sequence)values ($fid,'".$foldername."','".$folderdesc."',".$current_user->id.",$sequence)";
modules/EdTour/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/EdTour/EdTour.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/EdTour/EdTour.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/EdTour/EdTour.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/EdTour/EdTour.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/EdTour/EdTour.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/EdTour/EdTour.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/EdTour/EdTour.php:289:		if($record_user != $current_user->id){
modules/EdTour/EdTour.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/EdTour/EdTour.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/EdTour/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/EdTour/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/EdTour/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/EdTour/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/EdTour/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/EdTour/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/EdTour/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/EdTour/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/EdTour/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Emails/Emails.php:226:			$ownerid = $current_user->id;
modules/Emails/Emails.php:231:		$params1 = array($current_id, $current_user->id, $ownerid, $module . " Attachment", $this->column_fields['description'], $adb->formatDate($date_var, true), $adb->formatDate($date_var, true));
modules/Emails/Emails.php:610:		$ownerid = $current_user->id;
modules/Emails/Emails.php:622:		$params1 = array($current_id, $current_user->id, $ownerid, $module . " Attachment", $obj->column_fields['description'], $adb->formatDate($date_var, true), $adb->formatDate($date_var, true));
modules/Emails/Emails.php:645:	$ret = getFieldVisibilityPermission('Emails', $current_user->id, $fieldname, $mode);
modules/Emails/ListView.php:198:$smarty->assign("USERID", $current_user->id);
modules/Emails/mailSelect.php:27:$userid =  $current_user->id;
modules/Emails/mailsend.php:80:	$res1 = $adb->pquery($query1, array($current_user->id));
modules/Emails/mailsend.php:82://	$mail_status = send_mail('Emails',$to_email,$current_user->user_name,'',$_REQUEST['subject'],$_REQUEST['description'],$cc,$bcc,'all',$focus->id);
modules/Emails/mailsend.php:109:$from_name = $current_user->user_name;
modules/Emails/mailsend.php:110:$from_address = $current_user->column_fields['email1'];
modules/Emails/Save.php:156:$focus->column_fields["assigned_user_id"]=$current_user->id;
modules/Emails/Save.php:176:	$user_mail_status = send_mail('Emails',$current_user->column_fields['email1'],$current_user->user_name,'',$_REQUEST['subject'],$_REQUEST['description'],$_REQUEST['ccmail'],$_REQUEST['bccmail'],'all',$focus->id);
modules/Emails/SaveBookmarklet.php:78:$smarty->assign("userEmail",$current_user->column_fields['email1']);
modules/Emails/webmailsend.php:13:		$from_name = $current_user->user_name;
modules/Emails/webmailsend.php:14:		$from_add = $current_user->column_fields['email1'];
modules/Faq/DetailView.php:119:$focus->markAsViewed($current_user->id);
modules/HelpDesk/DetailView.php:89:        require("user_privileges/user_privileges_".$current_user->id.".php");
modules/HelpDesk/DetailView.php:146:$focus->markAsViewed($current_user->id);
modules/HelpDesk/HelpDesk.php:158:			$ownerId = $current_user->id;
modules/HelpDesk/HelpDesk.php:226:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/HelpDesk/HelpDesk.php:231:				if(getFieldVisibilityPermission('Events',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/HelpDesk/HelpDesk.php:387:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/HelpDesk/HelpDesk.php:602:				$updatelog .= " user ".getUserFullName($current_user->id);
modules/HelpDesk/HelpDesk.php:605:			$fldvalue = date("l dS F Y h:i:s A").' by '.$current_user->user_name;
modules/HelpDesk/HelpDesk.php:654:			$updatelog .= ' -- '.date("l dS F Y h:i:s A").' by '.$current_user->user_name.'--//--';
modules/HelpDesk/ListTickets.php:34:		$list_result_rows = $adb->pquery(mkCountQuery($search_query), array($current_user->id));
modules/HelpDesk/ListTickets.php:38:	$tktresult = $adb->pquery($search_query, array($current_user->id));
modules/HelpDesk/ListTickets.php:87:				'value' => getFullNameFromArray('Users', $current_user->column_fields),
modules/HelpDesk/Merge.php:84:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Home/chat.php:193:    $params = array($current_user->user_name, session_id(), $_SERVER['REMOTE_ADDR']);
modules/Home/home_rss.php:34:echo ("	  <webMaster>".$current_user->user_name."</webMaster>\n");
modules/Home/HomeBlock.php:35:	$smarty->assign("ALL_TAG",$freetag->get_tag_cloud_html("",$current_user->id));
modules/Home/HomestuffAjax.php:12:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Home/HomestuffAjax.php:27:		array_push($sparams, $current_user->id);
modules/Home/HomestuffAjax.php:39:			} else if($adb->query_result($result,$i,'userid')==$current_user->id){
modules/Home/HomestuffAjax.php:111:					$fld_permission = getFieldVisibilityPermission($fieldmodule,$current_user->id,$fieldname);
modules/Home/HomestuffAjax.php:195:	$result = $adb->pquery($sql, array($current_user->id));
modules/Home/HomestuffAjax.php:198:	$result = $adb->pquery($sql, array($current_user->id, $_REQUEST['layout']));
modules/Home/HomestuffAjax.php:208:	$homeWidgets = $focus->getHomeStuffOrder($current_user->id);
modules/Home/HomeUtils.php:235:	$result = $adb->pquery($sql, array($current_user->id));
modules/Home/HomeWidgetBlockList.php:43:		$smarty->assign("ALL_TAG",$freetag->get_tag_cloud_html("",$current_user->id));
modules/Home/HomeWidgetsSave.php:21:		$userId = $current_user->id;
modules/Home/index.php:83:$user_name = $current_user->column_fields['user_name'];
modules/Home/index.php:96:$smarty->assign("ALL_TAG",$freetag->get_tag_cloud_html("",$current_user->id));
modules/Home/index.php:113:$smarty->assign('FIRST_TIME_LOGIN', LoginHistory::firstTimeLoggedIn($current_user->user_name, $accept_login_delay_seconds));
modules/Home/LastViewed.php:34:$history = $tracker->get_recently_viewed($current_user->id);
modules/Home/SaveNotebookContents.php:36:	$adb->pquery($sql, array($contents, $current_user->id, $notebookid));
modules/Home/UnifiedSearch.php:98:					$where = getTagWhere($search_val,$current_user->id);					
modules/Hotel/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/Hotel/Hotel.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Hotel/Hotel.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Hotel/Hotel.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Hotel/Hotel.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Hotel/Hotel.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Hotel/Hotel.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Hotel/Hotel.php:289:		if($record_user != $current_user->id){
modules/Hotel/Hotel.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Hotel/Hotel.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Hotel/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Hotel/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Hotel/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Hotel/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Hotel/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Hotel/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Hotel/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/Hotel/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Hotel/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/IAT/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/IAT/IAT.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/IAT/IAT.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/IAT/IAT.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/IAT/IAT.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/IAT/IAT.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/IAT/IAT.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/IAT/IAT.php:289:		if($record_user != $current_user->id){
modules/IAT/IAT.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/IAT/IAT.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/IAT/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/IAT/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/IAT/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/IAT/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/IAT/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/IAT/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/IAT/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/IAT/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/IAT/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Import/controllers/Import_Index_Controller.php:39:		if(empty(self::$_cached_module_meta[$moduleName][$current_user->id])) {
modules/Import/controllers/Import_Index_Controller.php:41:			self::$_cached_module_meta[$moduleName][$current_user->id] = $moduleHandler->getMeta();
modules/Import/controllers/Import_Index_Controller.php:43:		$meta = self::$_cached_module_meta[$moduleName][$current_user->id];
modules/Import/resources/Utils.php:136:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Import/resources/Utils.php:137:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Import/resources/Utils.php:143:			return get_user_array(FALSE, "Active", $current_user->id,'private');
modules/Import/resources/Utils.php:145:			return get_user_array(FALSE, "Active", $current_user->id);
modules/Import/resources/Utils.php:151:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Import/resources/Utils.php:152:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Import/resources/Utils.php:158:			return get_group_array(FALSE, "Active", $current_user->id,'private');
modules/Import/resources/Utils.php:160:			return get_group_array(FALSE, "Active", $current_user->id);
modules/Inquiry/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/Inquiry/Inquiry.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Inquiry/Inquiry.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Inquiry/Inquiry.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Inquiry/Inquiry.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Inquiry/Inquiry.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Inquiry/Inquiry.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Inquiry/Inquiry.php:289:		if($record_user != $current_user->id){
modules/Inquiry/Inquiry.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Inquiry/Inquiry.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Inquiry/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Inquiry/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Inquiry/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Inquiry/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Inquiry/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Inquiry/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Inquiry/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/Inquiry/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Inquiry/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Invoice/DetailView.php:128:$focus->markAsViewed($current_user->id);
modules/Invoice/EditView.php:40:$currencyid = fetchCurrency($current_user->id);
modules/Invoice/Invoice.php:188:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Invoice/Invoice.php:284:		$invoicestatus_access = (getFieldVisibilityPermission('Invoice', $current_user->id, 'invoicestatus') != '0')? 1 : 0;
modules/Invoice/ListTopInvoice.php:168:            'value' => getFullNameFromArray('Users', $current_user->column_fields),
modules/Leads/CallRelatedList.php:58:		$userid = $current_user->id;
modules/Leads/ConvertLead.php:35:$smarty->assign('DATE_FORMAT', $current_user->date_format);
modules/Leads/ConvertLeadUI.php:40:		if (getFieldVisibilityPermission('Leads', $current_user->id, 'company') == '1') {
modules/Leads/ConvertLeadUI.php:130:		return $this->current_user->date_format;
modules/Leads/ConvertLeadUI.php:153:			$pick_list_values = getAssignedPicklistValues('industry', $this->current_user->roleid, $adb);
modules/Leads/ConvertLeadUI.php:171:			$pick_list_values = getAssignedPicklistValues('sales_stage', $this->current_user->roleid, $adb);
modules/Leads/ConvertLeadUI.php:180:		return $this->current_user->id;
modules/Leads/DetailView.php:70:if (getFieldVisibilityPermission($currentModule, $current_user->id, 'firstname') == '0') {
modules/Leads/DetailView.php:137:	require("user_privileges/user_privileges_" . $current_user->id . ".php");
modules/Leads/DetailView.php:173:$smarty->assign("USE_ASTERISK", get_use_asterisk($current_user->id));
modules/Leads/DetailView.php:194:$focus->markAsViewed($current_user->id);
modules/Leads/Leads.php:190:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Leads/Leads.php:195:				if(getFieldVisibilityPermission('Events',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Leads/Leads.php:457:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Leads/ListViewTop.php:37:		$result=$adb->pquery($query, array($current_user->id));
modules/Leads/ListViewTop.php:65:		$list_result_rows = $adb->pquery(mkCountQuery($list_query), array($startDateTime, $current_user->id));
modules/Leads/ListViewTop.php:69:	$list_result = $adb->pquery($list_query, array($startDateTime, $current_user->id));
modules/Leads/ListViewTop.php:122:            'value' => getFullNameFromArray('Users', $current_user->column_fields),
modules/Leads/Merge.php:89:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/MailManager/PopupMailManagerTemplate.php:45:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/MailManager/src/controllers/MailController.php:148:					$userFullName = getFullNameFromArray('Users', $current_user->column_fields);
modules/MailManager/src/controllers/MailController.php:149:					$userId = $current_user->id;
modules/MailManager/src/controllers/MailController.php:153:					$mailer->ConfigSenderInfo($fromEmail, $userFullName, $current_user->email1);
modules/MailManager/src/controllers/MailController.php:186:				$email->column_fields['assigned_user_id'] = $current_user->id;
modules/MailManager/src/controllers/MailController.php:289:						$document->column_fields['assigned_user_id'] = $current_user->id;
modules/MailManager/src/controllers/RelationController.php:205:                case 'ModComments': $focus->column_fields['assigned_user_id'] = $current_user->id;
modules/MailManager/src/controllers/RelationController.php:206:                                    $focus->column_fields['creator'] = $current_user->id;
modules/MailManager/src/controllers/UploadController.php:45:			$document->column_fields['assigned_user_id'] = $current_user->id;
modules/MailManager/src/controllers/UploadController.php:84:				Array($attachid, $current_user->id, $current_user->id, $current_user->id, "Documents Attachment", $description, $usetime, $usetime, 1, 0));
modules/MailManager/src/controllers/UploadController.php:159:			$document->column_fields['assigned_user_id'] = $current_user->id;
modules/MailManager/src/controllers/UploadController.php:197:				Array($attachid, $current_user->id, $current_user->id, $current_user->id, "Documents Attachment", $description, $usetime, $usetime, 1, 0));
modules/MailManager/src/models/Draft.php:163:		$email->column_fields['assigned_user_id'] = $current_user->id;
modules/MailManager/src/models/Draft.php:217:		if (empty($fromEmail)) $fromEmail = $current_user->column_fields['email1'];
modules/MailManager/src/models/Mailbox.php:104:		$adb->pquery("DELETE FROM vtiger_mail_accounts WHERE user_id = ? AND account_id = ?", array($current_user->id, $this->mId));
modules/MailManager/src/models/Mailbox.php:117:		$parameters = array($this->username(), $this->server(), $this->username(), $this->password(false), $this->protocol(), $this->ssltype(), $this->certvalidate(), $this->refreshTimeOut(), $current_user->id);
modules/MailManager/src/models/Mailbox.php:141:		$result = $adb->pquery("SELECT * FROM vtiger_mail_accounts WHERE user_id=? AND status=1 AND set_default=0", array($current_user->id));
modules/MailManager/src/models/Message.php:163:		WHERE userid=? AND lastsavedtime < ?", array($current_user->id, $waybacktime));
modules/MailManager/src/models/Message.php:165:		WHERE userid=? AND lastsavedtime < ?", array($current_user->id, $waybacktime));
modules/MailManager/src/models/Message.php:178:			WHERE userid=? AND lastsavedtime < ?", array($current_user->id, $waybacktime));
modules/MailManager/src/models/Message.php:203:			WHERE userid=? AND muid=?", array($current_user->id, $uid));
modules/MailManager/src/models/Message.php:243:			$params = array($current_user->id, $this->muid());
modules/MailManager/src/models/Message.php:284:		$params = array($current_user->id);
modules/MailManager/src/models/Message.php:314:					array($current_user->id, $uid, $attachInfo['attachid'], $attachInfo['name'], $attachInfo['path'], $savedtime));
modules/MailManager/src/models/Message.php:355:				Array($attachid, $current_user->id, $current_user->id, $current_user->id, "MailManager Attachment", $binFile, $usetime, $usetime, 1, 0));
modules/Migration/index.php:13:if($current_user->is_admin != 'on')
modules/Migration/MigrationCheck.php:13:if($current_user->is_admin != 'on')
modules/Migration/MigrationStep0.php:13:if($current_user->is_admin != 'on')
modules/Migration/MigrationStep1.php:12:if($current_user->is_admin != 'on')
modules/Migration/PatchApply.php:17:if($current_user->is_admin != 'on')
modules/Mobile/api/ws/FetchModuleFilters.php:25:				if($filter['userName'] == $current_user->column_fields['user_name']) {
modules/Mobile/api/ws/FetchModuleFilters.php:55:			array_push($parameters, $current_user->id);
modules/Mobile/api/ws/FetchRecordWithGrouping.php:81:				$templateRecord['assigned_user_id'] = sprintf("%sx%s", Mobile_WS_Utils::getEntityModuleWSId('Users'), $current_user->id);
modules/Mobile/api/ws/FetchRecordWithGrouping.php:143:						$field['type']['defaultValue'] = array('value' => "19x{$current_user->id}", 'label' => $current_user->column_fields['last_name']);
modules/Mobile/api/ws/Login.php:23:		$current_user->column_fields['user_name'] = $username;
modules/Mobile/api/ws/Login.php:30:		if(!$current_user->doLogin($password)) {
modules/Mobile/api/ws/Login.php:42:			$current_user->id = $current_user->retrieve_user_id($username);
modules/Mobile/api/ws/Login.php:47:				'userid' => $current_user->id,
modules/Mobile/api/ws/Login.php:49:				'user_tz' => $current_user->time_zone,
modules/Mobile/api/ws/SyncModuleRecords.php:25:		$current_user_wsid = sprintf("%sx%s", Mobile_WS_Utils::getEntityModuleWSId("Users"), $current_user->id);
modules/Mobile/api/ws/SyncModuleRecords.php:120:					$queryDeletedParameters[] = $current_user->id;
modules/Mobile/api/ws/Utils.php:289:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Mobile/api/ws/Utils.php:290:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Mobile/api/ws/Utils.php:298:				$querySuffix .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Mobile/api/ws/Utils.php:308:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Mobile/api/ws/Utils.php:321:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ModComments/DetailView.php:101:$focus->markAsViewed($current_user->id);
modules/ModComments/DetailViewAjax.php:20:		$modObj->column_fields['assigned_user_id'] = $current_user->id;
modules/ModComments/DetailViewAjax.php:23:		if(empty($modObj->column_fields['smcreatorid'])) $modObj->column_fields['smcreatorid'] = $current_user->id;
modules/ModComments/ModCommentsCore.php:202:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ModComments/ModCommentsCore.php:203:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ModComments/ModCommentsCore.php:211:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN
modules/ModComments/ModCommentsCore.php:221:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ModComments/ModCommentsCore.php:234:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ModComments/ModCommentsCore.php:289:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ModComments/ModCommentsCore.php:290:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ModComments/widgets/DetailViewBlockComment.php:77:				case 'Mine': $queryCriteria = ' AND vtiger_crmentity.smownerid=' . $current_user->id.sprintf(" ORDER BY %s.%s DESC ", $entityInstance->table_name, $entityInstance->table_index); break;
modules/ModCreator/storage/DetailViewUtils.php:54:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/DetailViewUtils.php:55:	require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/DetailViewUtils.php:146:		$roleid = $current_user->roleid;
modules/ModCreator/storage/DetailViewUtils.php:197:		$roleid = $current_user->roleid;
modules/ModCreator/storage/DetailViewUtils.php:277:			$assigned_user_id = $current_user->id;
modules/ModCreator/storage/DetailViewUtils.php:350:			$assigned_user_id = $current_user->id;
modules/ModCreator/storage/DetailViewUtils.php:359:			$users_combo = get_select_options_array(get_user_array(FALSE, "Active", $current_user->id, 'private'), $assigned_user_id);
modules/ModCreator/storage/DetailViewUtils.php:361:			$users_combo = get_select_options_array(get_user_array(FALSE, "Active", $current_user->id), $assigned_user_id);
modules/ModCreator/storage/DetailViewUtils.php:366:				$groups_combo = get_select_options_array(get_group_array(FALSE, "Active", $current_user->id, 'private'), $current_user->id);
modules/ModCreator/storage/DetailViewUtils.php:368:				$groups_combo = get_select_options_array(get_group_array(FALSE, "Active", $current_user->id), $current_user->id);
modules/ModCreator/storage/DetailViewUtils.php:391:			$fieldpermission = getFieldVisibilityPermission($currentModule, $current_user->id, 'firstname');
modules/ModCreator/storage/DetailViewUtils.php:396:			$roleid = $current_user->roleid;
modules/ModCreator/storage/DetailViewUtils.php:409:				$params = array($current_user->roleid);
modules/ModCreator/storage/DetailViewUtils.php:1077:			if ($current_user->theme == $theme) {
modules/ModCreator/storage/DetailViewUtils.php:1092:			if ($current_user->language == $prefix) {
modules/ModCreator/storage/DetailViewUtils.php:1513:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/DetailViewUtils.php:1561:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/DetailViewUtils.php:1612:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/EditViewUtils.php:49:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/EditViewUtils.php:50:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/EditViewUtils.php:151:				$fieldvalue[] = array($date_format=>$current_user->date_format.' '.$app_strings['YEAR_MONTH_DATE']);
modules/ModCreator/storage/EditViewUtils.php:154:				$fieldvalue[] = array($date_format=>$current_user->date_format);
modules/ModCreator/storage/EditViewUtils.php:158:			$fieldvalue[] = array($date_format=>$current_user->date_format.' '.$app_strings['YEAR_MONTH_DATE']);
modules/ModCreator/storage/EditViewUtils.php:199:		$roleid=$current_user->roleid;
modules/ModCreator/storage/EditViewUtils.php:279:			$assigned_user_id = $current_user->id;
modules/ModCreator/storage/EditViewUtils.php:328:				$assigned_user_id = $current_user->id;
modules/ModCreator/storage/EditViewUtils.php:395:			$fieldpermission = getFieldVisibilityPermission($module_name, $current_user->id,'firstname', 'readwrite');
modules/ModCreator/storage/EditViewUtils.php:400:			$fieldpermission = getFieldVisibilityPermission($module_name, $current_user->id,'salutationtype', 'readwrite');
modules/ModCreator/storage/EditViewUtils.php:402:				$roleid=$current_user->roleid;
modules/ModCreator/storage/EditViewUtils.php:555:			$assigned_user_id = $current_user->id;
modules/ModCreator/storage/EditViewUtils.php:1285:			if($current_user->theme == $theme) {
modules/ModCreator/storage/EditViewUtils.php:1298:			if($current_user->language == $prefix) {
modules/ModCreator/storage/EditViewUtils.php:1359:		if (getFieldVisibilityPermission('SalesOrder', $current_user->id,$xyz[$i]) == '0'){
modules/ModCreator/storage/EditViewUtils.php:1411:		if (getFieldVisibilityPermission('Quotes', $current_user->id,$xyz[$i]) == '0'){
modules/ModCreator/storage/EditViewUtils.php:1455:			if (getFieldVisibilityPermission('Quotes', $current_user->id,$xyz[$i]) == '0'){
modules/ModCreator/storage/ListViewUtils.php:73:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:239:					if ((getFieldVisibilityPermission('Events', $current_user->id, 'eventstatus') == '0') || (getFieldVisibilityPermission('Calendar', $current_user->id, 'taskstatus') == '0')) {
modules/ModCreator/storage/ListViewUtils.php:304:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:349:		require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:511:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:684:									if (getFieldVisibilityPermission('Calendar', $current_user->id, $fieldname) == '0') {
modules/ModCreator/storage/ListViewUtils.php:690:									if (getFieldVisibilityPermission('Events', $current_user->id, $fieldname) == '0') {
modules/ModCreator/storage/ListViewUtils.php:920:								if (getFieldVisibilityPermission('Calendar', $current_user->id, $fieldname) == '0') {
modules/ModCreator/storage/ListViewUtils.php:927:								if (getFieldVisibilityPermission('Events', $current_user->id, $fieldname) == '0') {
modules/ModCreator/storage/ListViewUtils.php:946:							if ((getFieldVisibilityPermission('Events', $current_user->id, 'eventstatus') == '0') || (getFieldVisibilityPermission('Calendar', $current_user->id, 'taskstatus') == '0')) {
modules/ModCreator/storage/ListViewUtils.php:1031:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:1164:				require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:1175:				if (getFieldVisibilityPermission($module, $current_user->id, 'unit_price') == '0') {
modules/ModCreator/storage/ListViewUtils.php:1218:				require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:1229:				if (getFieldVisibilityPermission($module, $current_user->id, 'unit_price') == '0') {
modules/ModCreator/storage/ListViewUtils.php:1272:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:1372:			$roleid = $current_user->roleid;
modules/ModCreator/storage/ListViewUtils.php:1664:				$roleid = $current_user->roleid;
modules/ModCreator/storage/ListViewUtils.php:1768:							if (getFieldVisibilityPermission($module, $current_user->id, $xyz[$i]) == '0') {
modules/ModCreator/storage/ListViewUtils.php:1828:					if (getFieldVisibilityPermission('Products', $current_user->id, 'unit_price') == '0') {
modules/ModCreator/storage/ListViewUtils.php:1878:					if (getFieldVisibilityPermission($module, $current_user->id, 'unit_price') == '0') {
modules/ModCreator/storage/ListViewUtils.php:1924:					if (getFieldVisibilityPermission('Services', $current_user->id, 'unit_price') == '0') {
modules/ModCreator/storage/ListViewUtils.php:1962:						if (getFieldVisibilityPermission($module, $current_user->id, $xyz[$i]) == '0') {
modules/ModCreator/storage/ListViewUtils.php:2004:							if (getFieldVisibilityPermission('Accounts', $current_user->id, $xyz[$i]) == '0') {
modules/ModCreator/storage/ListViewUtils.php:2132:						if (getFieldVisibilityPermission($module, $current_user->id, $xyz[$i]) == '0') {
modules/ModCreator/storage/ListViewUtils.php:2246:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:2247:	require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:2727:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:2728:	require('user_privileges/sharing_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:3130:			if ($current_user->activity_view == "This Year") {
modules/ModCreator/storage/ListViewUtils.php:3132:			} else if ($current_user->activity_view == "This Month") {
modules/ModCreator/storage/ListViewUtils.php:3134:			} else if ($current_user->activity_view == "This Week") {
modules/ModCreator/storage/ListViewUtils.php:3918:		$result = $adb->pquery($sql, array($tabid, $current_user->id));
modules/ModCreator/storage/ListViewUtils.php:3923:	$user_profileid = fetchUserProfileId($current_user->id);
modules/ModCreator/storage/ListViewUtils.php:3933:	require('user_privileges/user_privileges_' . $current_user->id . '.php');
modules/ModCreator/storage/ListViewUtils.php:4031:			if ($current_user->activity_view == "This Year") {
modules/ModCreator/storage/ListViewUtils.php:4033:			} else if ($current_user->activity_view == "This Month") {
modules/ModCreator/storage/ListViewUtils.php:4035:			} else if ($current_user->activity_view == "This Week") {
modules/ModCreator/storage/modulefile/Test2/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:106:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:107:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:115:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:125:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:138:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:216:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:254:		if($record_user != $current_user->id){
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:257:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ModCreator/storage/modulefile/Test2/ModuleFooter.php:263:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ModCreator/storage/modulefile/Test2/Test2.php:107:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/modulefile/Test2/Test2.php:108:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/modulefile/Test2/Test2.php:116:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/ModCreator/storage/modulefile/Test2/Test2.php:126:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ModCreator/storage/modulefile/Test2/Test2.php:139:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ModCreator/storage/modulefile/Test2/Test2.php:217:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/ModCreator/storage/modulefile/Test2/Test2.php:255:		if($record_user != $current_user->id){
modules/ModCreator/storage/modulefile/Test2/Test2.php:258:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ModCreator/storage/modulefile/Test2/Test2.php:264:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ModCreator/storage/modulefolder/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/ModCreator/storage/modulefolder/ModuleFile.php:200:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/modulefolder/ModuleFile.php:201:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/modulefolder/ModuleFile.php:209:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/ModCreator/storage/modulefolder/ModuleFile.php:219:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ModCreator/storage/modulefolder/ModuleFile.php:232:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ModCreator/storage/modulefolder/ModuleFile.php:310:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/ModCreator/storage/modulefolder/ModuleFile.php:348:		if($record_user != $current_user->id){
modules/ModCreator/storage/modulefolder/ModuleFile.php:351:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ModCreator/storage/modulefolder/ModuleFile.php:357:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ModCreator/storage/modulefolder/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/modulefolder/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ModCreator/storage/modulefolder/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/ModCreator/storage/modulefolder/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ModCreator/storage/modulefolder/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ModCreator/storage/modulefolder/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/ModCreator/storage/modulefolder/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/ModCreator/storage/modulefolder/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ModCreator/storage/modulefolder/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/ModTracker/core/ModTracker_Basic.php:63:		if (isset($current_user) && $current_user->id == $this->whodid) {
modules/ModTracker/core/ModTracker_Basic.php:64:			return getFullNameFromArray('Users', $current_user->column_fields);
modules/ModTracker/core/ModTracker_Detail.php:72:		return (getFieldVisibilityPermission($this->parent->module, $current_user->id, $this->name) == '0');
modules/ModTracker/core/ModTracker_Field.php:90:				$accessiblePicklistValues = getAssignedPicklistValues($fieldName, $current_user->roleid, $adb);
modules/ModTracker/core/ModTracker_Field.php:166:				$accessiblePicklistValues = getAssignedPicklistValues($fieldName, $current_user->roleid, $adb);
modules/ModTracker/ModTrackerHandler.php:46:                                            $current_user->id, $newerColumnFields['modifiedtime'], $status));
modules/ModTracker/ModTrackerHandler.php:61:                    VALUES(?,?,?,?,?,?)', Array($id, $recordId, $moduleName, $current_user->id, date('Y-m-d H:i:s',time()), ModTracker::$DELETED));
modules/NonTradeR/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/NonTradeR/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/NonTradeR/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/NonTradeR/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/NonTradeR/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/NonTradeR/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/NonTradeR/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/NonTradeR/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/NonTradeR/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/NonTradeR/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/NonTradeR/NonTradeR.php:1:<?php/*+********************************************************************************** * The contents of this file are subject to the vtiger CRM Public License Version 1.0 * ("License"); You may not use this file except in compliance with the License * The Original Code is:  vtiger CRM Open Source * The Initial Developer of the Original Code is vtiger. * Portions created by vtiger are Copyright (C) vtiger. * All Rights Reserved. ************************************************************************************/require_once('data/CRMEntity.php');require_once('data/Tracker.php');class NonTradeR extends CRMEntity {	var $db, $log; // Used in class functions of CRMEntity	var $table_name = 'vtiger_nontrader';	var $table_index= 'nontraderid';	var $column_fields = Array();	/** Indicator if this is a custom module or standard module */	var $IsCustomModule = true;	/**	 * Mandatory table for supporting custom fields.	 */	var $customFieldTable = Array('vtiger_nontradercf', 'nontraderid');	var $related_tables = Array ('vtiger_nontradercf' => Array('nontraderid'));	/**	 * Mandatory for Saving, Include tables related to this module.	 */	var $tab_name = Array('vtiger_crmentity', 'vtiger_nontrader', 'vtiger_nontradercf');	/**	 * Mandatory for Saving, Include tablename and tablekey columnname here.	 */	var $tab_name_index = Array(		'vtiger_crmentity' => 'crmid',		'vtiger_nontrader'   => 'nontraderid',	    'vtiger_nontradercf' => 'nontraderid');		/**	 * Mandatory for Listing (Related listview)	 */	var $list_fields = Array (		/* Format: Field Label => Array(tablename, columnname) */		// tablename should not have prefix 'vtiger_'		'NTR No' => Array('nontrader','ntr_no'),'NTR Type' => Array('nontrader','ntr_type'),'Contact Person' => Array('nontrader','contact_person'),'Receivable' => Array('nontrader','receivable'),'Other' => Array('nontrader','other'),'Currency' => Array('nontrader','ntr_currency'),'PO No' => Array('nontrader','po_no'),'Supplier' => Array('nontrader','supplier')	);	var $list_fields_name = Array(		/* Format: Field Label => fieldname */		'NTR No' => 'ntr_no','NTR Type' => 'ntr_type','Contact Person' => 'contact_person','Receivable' => 'receivable','Other' => 'other','Currency' => 'ntr_currency','PO No' => 'po_no','Supplier' => 'supplier'	);	// Make the field link to detail view from list view (Fieldname)	var $list_link_field = 'ntr_no';	// For Popup listview and UI type support	var $search_fields = Array(		/* Format: Field Label => Array(tablename, columnname) */		// tablename should not have prefix 'vtiger_'		'NTR No' => Array('nontrader','ntr_no'),'NTR Type' => Array('nontrader','ntr_type'),'Contact Person' => Array('nontrader','contact_person'),'Receivable' => Array('nontrader','receivable'),'Other' => Array('nontrader','other'),'Currency' => Array('nontrader','ntr_currency'),'PO No' => Array('nontrader','po_no'),'Supplier' => Array('nontrader','supplier')	);	var $search_fields_name = Array(		/* Format: Field Label => fieldname */		'NTR No' => 'ntr_no','NTR Type' => 'ntr_type','Contact Person' => 'contact_person','Receivable' => 'receivable','Other' => 'other','Currency' => 'ntr_currency','PO No' => 'po_no','Supplier' => 'supplier'	);	// For Popup window record selection	var $popup_fields = Array('ntr_no');	// Placeholder for sort fields - All the fields will be initialized for Sorting through initSortFields	var $sortby_fields = Array();	// For Alphabetical search	var $def_basicsearch_col = 'ntr_no';	// Column value to use on detail view record text display	var $def_detailview_recname = 'ntr_no';	// Required Information for enabling Import feature	var $required_fields = Array('ntr_no'=>1);	// Callback function list during Importing	var $special_functions = Array('set_import_assigned_user');	var $default_order_by = 'ntr_no';	var $default_sort_order='ASC';	// Used when enabling/disabling the mandatory fields for the module.	// Refers to vtiger_field.fieldname values.	var $mandatory_fields = Array('createdtime', 'modifiedtime', 'ntr_no');	function __construct() {		global $log, $currentModule;		$this->column_fields = getColumnFields($currentModule);		$this->db = PearDatabase::getInstance();		$this->log = $log;	}	function getSortOrder() {		global $currentModule;		$sortorder = $this->default_sort_order;		if($_REQUEST['sorder']) $sortorder = $this->db->sql_escape_string($_REQUEST['sorder']);		else if($_SESSION[$currentModule.'_Sort_Order']) 			$sortorder = $_SESSION[$currentModule.'_Sort_Order'];		return $sortorder;	}	function getOrderBy() {		global $currentModule;				$use_default_order_by = '';				if(PerformancePrefs::getBoolean('LISTVIEW_DEFAULT_SORTING', true)) {			$use_default_order_by = $this->default_order_by;		}				$orderby = $use_default_order_by;		if($_REQUEST['order_by']) $orderby = $this->db->sql_escape_string($_REQUEST['order_by']);		else if($_SESSION[$currentModule.'_Order_By'])			$orderby = $_SESSION[$currentModule.'_Order_By'];		return $orderby;	}	function save_module($module) {		$this->insertIntoAttachment($this->id,$module);	}	function insertIntoAttachment($id,$module)	{		global $log, $adb;		$log->debug("Entering into insertIntoAttachment($id,$module) method.");		$file_saved = false;		//This is to added to store the existing attachment id of the contact where we should delete this when we give new image		$old_attachmentid = $adb->query_result($adb->pquery("select vtiger_crmentity.crmid from vtiger_seattachmentsrel inner join vtiger_crmentity on vtiger_crmentity.crmid=vtiger_seattachmentsrel.attachmentsid where  vtiger_seattachmentsrel.crmid=?", array($id)),0,'crmid');		foreach($_FILES as $fileindex => $files)		{			if($files['name'] != '' && $files['size'] > 0)			{				$files['original_name'] = vtlib_purify($_REQUEST[$fileindex.'_hidden']);				$file_saved = $this->uploadAndSaveFile($id,$module,$files);			}		}		//This is to handle the delete image for contacts		if($file_saved)		{			if($old_attachmentid != '')			{				$setype = $adb->query_result($adb->pquery("select setype from vtiger_crmentity where crmid=?", array($old_attachmentid)),0,'setype');					$del_res1 = $adb->pquery("delete from vtiger_attachments where attachmentsid=?", array($old_attachmentid));					$del_res2 = $adb->pquery("delete from vtiger_seattachmentsrel where attachmentsid=?", array($old_attachmentid));			}		}		$log->debug("Exiting from insertIntoAttachment($id,$module) method.");	}	/**	 * Return query to use based on given modulename, fieldname	 * Useful to handle specific case handling for Popup	 */	function getQueryByModuleField($module, $fieldname, $srcrecord, $query='') {		// $srcrecord could be empty	}	/**	 * Get list view query (send more WHERE clause condition if required)	 */	function getListQuery($module, $usewhere='') {		$query = "SELECT vtiger_crmentity.*, $this->table_name.*";				// Keep track of tables joined to avoid duplicates		$joinedTables = array();		// Select Custom Field Table Columns if present		if(!empty($this->customFieldTable)) $query .= ", " . $this->customFieldTable[0] . ".* ";		$query .= " FROM $this->table_name";		$query .= "	INNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = $this->table_name.$this->table_index";		$joinedTables[] = $this->table_name;		$joinedTables[] = 'vtiger_crmentity';				// Consider custom table join as well.		if(!empty($this->customFieldTable)) {			$query .= " INNER JOIN ".$this->customFieldTable[0]." ON ".$this->customFieldTable[0].'.'.$this->customFieldTable[1] .				      " = $this->table_name.$this->table_index";			$joinedTables[] = $this->customFieldTable[0]; 		}		$query .= " LEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid";		$query .= " LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid";		$joinedTables[] = 'vtiger_users';		$joinedTables[] = 'vtiger_groups';				$linkedModulesQuery = $this->db->pquery("SELECT distinct fieldname, columnname, relmodule FROM vtiger_field" .				" INNER JOIN vtiger_fieldmodulerel ON vtiger_fieldmodulerel.fieldid = vtiger_field.fieldid" .				" WHERE uitype='10' AND vtiger_fieldmodulerel.module=?", array($module));		$linkedFieldsCount = $this->db->num_rows($linkedModulesQuery);				for($i=0; $i<$linkedFieldsCount; $i++) {			$related_module = $this->db->query_result($linkedModulesQuery, $i, 'relmodule');			$fieldname = $this->db->query_result($linkedModulesQuery, $i, 'fieldname');			$columnname = $this->db->query_result($linkedModulesQuery, $i, 'columnname');						$other =  CRMEntity::getInstance($related_module);			vtlib_setup_modulevars($related_module, $other);						if(!in_array($other->table_name, $joinedTables)) {				$query .= " LEFT JOIN $other->table_name ON $other->table_name.$other->table_index = $this->table_name.$columnname";				$joinedTables[] = $other->table_name;			}		}		global $current_user;		$query .= $this->getNonAdminAccessControlQuery($module,$current_user);		$query .= "	WHERE vtiger_crmentity.deleted = 0 ".$usewhere;		return $query;	}	/**	 * Apply security restriction (sharing privilege) query part for List view.	 */	function getListViewSecurityParameter($module) {		global $current_user;		require('user_privileges/user_privileges_'.$current_user->id.'.php');		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');		$sec_query = '';		$tabid = getTabid($module);		if($is_admin==false && $profileGlobalPermission[1] == 1 && $profileGlobalPermission[2] == 1 			&& $defaultOrgSharingPermission[$tabid] == 3) {				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 					(						SELECT vtiger_user2role.userid FROM vtiger_user2role 						INNER JOIN vtiger_users ON vtiger_users.id=vtiger_user2role.userid 						INNER JOIN vtiger_role ON vtiger_role.roleid=vtiger_user2role.roleid 						WHERE vtiger_role.parentrole LIKE '".$current_user_parent_role_seq."::%'					) 					OR vtiger_crmentity.smownerid IN 					(						SELECT shareduserid FROM vtiger_tmp_read_user_sharing_per 						WHERE userid=".$current_user->id." AND tabid=".$tabid."					) 					OR 						(";							// Build the query based on the group association of current user.					if(sizeof($current_user_groups) > 0) {						$sec_query .= " vtiger_groups.groupid IN (". implode(",", $current_user_groups) .") OR ";					}					$sec_query .= " vtiger_groups.groupid IN 						(							SELECT vtiger_tmp_read_group_sharing_per.sharedgroupid 							FROM vtiger_tmp_read_group_sharing_per							WHERE userid=".$current_user->id." and tabid=".$tabid."						)";				$sec_query .= ")				)";		}		return $sec_query;	}	/**	 * Create query to export the records.	 */	function create_export_query($where)	{		global $current_user;		$thismodule = $_REQUEST['module'];				include("include/utils/ExportUtils.php");		//To get the Permitted fields query and the permitted fields list		$sql = getPermittedFieldsQuery($thismodule, "detail_view");				$fields_list = getFieldsListFromQuery($sql);		$query = "SELECT $fields_list, vtiger_users.user_name AS user_name 					FROM vtiger_crmentity INNER JOIN $this->table_name ON vtiger_crmentity.crmid=$this->table_name.$this->table_index";		if(!empty($this->customFieldTable)) {			$query .= " INNER JOIN ".$this->customFieldTable[0]." ON ".$this->customFieldTable[0].'.'.$this->customFieldTable[1] .				      " = $this->table_name.$this->table_index"; 		}		$query .= " LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid";		$query .= " LEFT JOIN vtiger_users ON vtiger_crmentity.smownerid = vtiger_users.id and vtiger_users.status='Active'";				$linkedModulesQuery = $this->db->pquery("SELECT distinct fieldname, columnname, relmodule FROM vtiger_field" .				" INNER JOIN vtiger_fieldmodulerel ON vtiger_fieldmodulerel.fieldid = vtiger_field.fieldid" .				" WHERE uitype='10' AND vtiger_fieldmodulerel.module=?", array($thismodule));		$linkedFieldsCount = $this->db->num_rows($linkedModulesQuery);		for($i=0; $i<$linkedFieldsCount; $i++) {			$related_module = $this->db->query_result($linkedModulesQuery, $i, 'relmodule');			$fieldname = $this->db->query_result($linkedModulesQuery, $i, 'fieldname');			$columnname = $this->db->query_result($linkedModulesQuery, $i, 'columnname');						$other = CRMEntity::getInstance($related_module);			vtlib_setup_modulevars($related_module, $other);						$query .= " LEFT JOIN $other->table_name ON $other->table_name.$other->table_index = $this->table_name.$columnname";		}		$query .= $this->getNonAdminAccessControlQuery($thismodule,$current_user);		$where_auto = " vtiger_crmentity.deleted=0";		if($where != '') $query .= " WHERE ($where) AND $where_auto";		else $query .= " WHERE $where_auto";		return $query;	}	/**	 * Initialize this instance for importing.	 */	function initImport($module) {		$this->db = PearDatabase::getInstance();		$this->initImportableFields($module);	}	/**	 * Create list query to be shown at the last step of the import.	 * Called From: modules/Import/UserLastImport.php	 */	function create_import_query($module) {		global $current_user;		$query = "SELECT vtiger_crmentity.crmid, case when (vtiger_users.user_name not like '') then vtiger_users.user_name else vtiger_groups.groupname end as user_name, $this->table_name.* FROM $this->table_name			INNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = $this->table_name.$this->table_index			LEFT JOIN vtiger_users_last_import ON vtiger_users_last_import.bean_id=vtiger_crmentity.crmid			LEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid			LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'			AND vtiger_users_last_import.bean_type='$module'			AND vtiger_users_last_import.deleted=0";		return $query;	}	/**	 * Delete the last imported records.	 */	function undo_import($module, $user_id) {		global $adb;		$count = 0;		$query1 = "select bean_id from vtiger_users_last_import where assigned_user_id=? AND bean_type='$module' AND deleted=0";		$result1 = $adb->pquery($query1, array($user_id)) or die("Error getting last import for undo: ".mysql_error()); 		while ( $row1 = $adb->fetchByAssoc($result1))		{			$query2 = "update vtiger_crmentity set deleted=1 where crmid=?";			$result2 = $adb->pquery($query2, array($row1['bean_id'])) or die("Error undoing last import: ".mysql_error()); 			$count++;					}		return $count;	}		/**	 * Transform the value while exporting	 */	function transform_export_value($key, $value) {		return parent::transform_export_value($key, $value);	}	/**	 * Function which will set the assigned user id for import record.	 */	function set_import_assigned_user()	{		global $current_user, $adb;		$record_user = $this->column_fields["assigned_user_id"];				if($record_user != $current_user->id){			$sqlresult = $adb->pquery("select id from vtiger_users where id = ? union select groupid as id from vtiger_groups where groupid = ?", array($record_user, $record_user));			if($this->db->num_rows($sqlresult)!= 1) {				$this->column_fields["assigned_user_id"] = $current_user->id;			} else {							$row = $adb->fetchByAssoc($sqlresult, -1, false);				if (isset($row['id']) && $row['id'] != -1) {					$this->column_fields["assigned_user_id"] = $row['id'];				} else {					$this->column_fields["assigned_user_id"] = $current_user->id;				}			}		}	}		/** 	 * Function which will give the basic query to find duplicates	 */	function getDuplicatesQuery($module,$table_cols,$field_values,$ui_type_arr,$select_cols='') {		$select_clause = "SELECT ". $this->table_name .".".$this->table_index ." AS recordid, vtiger_users_last_import.deleted,".$table_cols;		// Select Custom Field Table Columns if present		if(isset($this->customFieldTable)) $query .= ", " . $this->customFieldTable[0] . ".* ";		$from_clause = " FROM $this->table_name";		$from_clause .= "	INNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = $this->table_name.$this->table_index";		// Consider custom table join as well.		if(isset($this->customFieldTable)) {			$from_clause .= " INNER JOIN ".$this->customFieldTable[0]." ON ".$this->customFieldTable[0].'.'.$this->customFieldTable[1] .				      " = $this->table_name.$this->table_index"; 		}		$from_clause .= " LEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid						LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid";				$where_clause = "	WHERE vtiger_crmentity.deleted = 0";		$where_clause .= $this->getListViewSecurityParameter($module);							if (isset($select_cols) && trim($select_cols) != '') {			$sub_query = "SELECT $select_cols FROM  $this->table_name AS t " .				" INNER JOIN vtiger_crmentity AS crm ON crm.crmid = t.".$this->table_index;			// Consider custom table join as well.			if(isset($this->customFieldTable)) {				$sub_query .= " LEFT JOIN ".$this->customFieldTable[0]." tcf ON tcf.".$this->customFieldTable[1]." = t.$this->table_index";			}			$sub_query .= " WHERE crm.deleted=0 GROUP BY $select_cols HAVING COUNT(*)>1";			} else {			$sub_query = "SELECT $table_cols $from_clause $where_clause GROUP BY $table_cols HAVING COUNT(*)>1";		}							$query = $select_clause . $from_clause .					" LEFT JOIN vtiger_users_last_import ON vtiger_users_last_import.bean_id=" . $this->table_name .".".$this->table_index .					" INNER JOIN (" . $sub_query . ") AS temp ON ".get_on_clause($field_values,$ui_type_arr,$module) .					$where_clause .					" ORDER BY $table_cols,". $this->table_name .".".$this->table_index ." ASC";							return $query;			}	/**	 * Invoked when special actions are performed on the module.	 * @param String Module name	 * @param String Event Type (module.postinstall, module.disabled, module.enabled, module.preuninstall)	 */	function vtlib_handler($modulename, $event_type) {		if($event_type == 'module.postinstall') {			// TODO Handle post installation actions		} else if($event_type == 'module.disabled') {			// TODO Handle actions when this module is disabled.		} else if($event_type == 'module.enabled') {			// TODO Handle actions when this module is enabled.		} else if($event_type == 'module.preuninstall') {			// TODO Handle actions when this module is about to be deleted.		} else if($event_type == 'module.preupdate') {			// TODO Handle actions before this module is updated.		} else if($event_type == 'module.postupdate') {			// TODO Handle actions after this module is updated.		}	}	/** 	 * Handle saving related module information.	 * NOTE: This function has been added to CRMEntity (base class).	 * You can override the behavior by re-defining it here.	 */	// function save_related_module($module, $crmid, $with_module, $with_crmid) { }		/**	 * Handle deleting related module information.	 * NOTE: This function has been added to CRMEntity (base class).	 * You can override the behavior by re-defining it here.	 */	//function delete_related_module($module, $crmid, $with_module, $with_crmid) { }	/**	 * Handle getting related list information.	 * NOTE: This function has been added to CRMEntity (base class).	 * You can override the behavior by re-defining it here.	 */	//function get_related_list($id, $cur_tab_id, $rel_tab_id, $actions=false) { }	/**	 * Handle getting dependents list information.	 * NOTE: This function has been added to CRMEntity (base class).	 * You can override the behavior by re-defining it here.	 */	//function get_dependents_list($id, $cur_tab_id, $rel_tab_id, $actions=false) { }}?>
modules/Others/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/Others/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Others/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Others/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Others/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Others/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Others/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Others/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/Others/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Others/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Others/Others.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Others/Others.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Others/Others.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Others/Others.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Others/Others.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Others/Others.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Others/Others.php:289:		if($record_user != $current_user->id){
modules/Others/Others.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Others/Others.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PBXManager/AsteriskUtils.php:164:	$current_user->date_format = $old_userdate_format;
modules/PBXManager/AsteriskUtils.php:201:	$focus->column_fields['subject'] = "Outgoing call from $current_user->user_name ($extension)";
modules/PBXManager/AsteriskUtils.php:208:	$focus->column_fields['assigned_user_id'] = $current_user->id;
modules/PBXManager/PBXManager.php:106:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/PBXManager/PBXManager.php:107:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/PBXManager/PBXManager.php:115:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/PBXManager/PBXManager.php:125:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/PBXManager/PBXManager.php:143:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/PBXManager/PBXManager.php:188:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/PBXManager/PBXManager.php:189:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/PBXManager/StartCall.php:24:	$id = $current_user->id;
modules/PBXManager/StartCall.php:27:	$result = $adb->query("select * from vtiger_asteriskextensions where userid=".$current_user->id);
modules/PBXManager/TraceIncomingCall.php:28:	if(isset($current_user->column_fields)) {
modules/PBXManager/TraceIncomingCall.php:29:		$asterisk_extension = $current_user->column_fields['asterisk_extension'];
modules/PBXManager/TraceIncomingCall.php:32:		$result = $adb->pquery($sql, array($current_user->id));
modules/PBXManager/TraceIncomingCall.php:71:				$activityid = asterisk_addToActivityHistory($callerName, $callerNumber, $callerType, $adb, $current_user->id, $relcrmid, $firstCallerInfo);
modules/PO/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/PO/DetailView.php:126:if( ($current_user->roleid == SUPERVISOR 
modules/PO/DetailView.php:127:	|| $current_user->roleid == RESERVATION 
modules/PO/DetailView.php:128:	|| $current_user->roleid == ADMIN) 
modules/PO/DetailView.php:133:if ( $current_user->roleid != ADMIN && $focus->column_fields['po_status'] == 'Approved' ) {
modules/PO/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/PO/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/PO/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/PO/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/PO/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/PO/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/PO/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/PO/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PO/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PO/PO.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/PO/PO.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/PO/PO.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/PO/PO.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/PO/PO.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/PO/PO.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/PO/PO.php:289:		if($record_user != $current_user->id){
modules/PO/PO.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PO/PO.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Potentials/Charts.php:127:						$amount = convertFromMasterCurrency(preg_replace('/[^0-9]/', '', floor($record->column_fields['amount'])),$current_user->conv_rate);
modules/Potentials/Charts.php:268:			$titlestr = $current_module_strings['LBL_TOTAL_PIPELINE'].$current_user->currency_symbol.$total.$app_strings['LBL_THOUSANDS_SYMBOL'];
modules/Potentials/Charts.php:269:				//$titlestr = $current_module_strings['LBL_TOTAL_PIPELINE'].$current_user->currency_symbol.$total;
modules/Potentials/Charts.php:305:			$valueproc =& Image_Graph::factory('Image_Graph_DataPreprocessor_Formatted', $current_user->currency_symbol."%d");
modules/Potentials/Charts.php:330:			$subtitle .= $current_module_strings['LBL_OPP_SIZE'].$current_user->currency_symbol.$current_module_strings['LBL_OPP_SIZE_VALUE'];
modules/Potentials/Charts.php:463:						$amount = convertFromMasterCurrency(preg_replace('/[^0-9]/', '', floor($record->column_fields['amount'])),$current_user->conv_rate);
modules/Potentials/Charts.php:601:			$titlestr = $current_module_strings['LBL_ALL_OPPORTUNITIES'].$current_user->currency_symbol.$total.$app_strings['LBL_THOUSANDS_SYMBOL'];
modules/Potentials/Charts.php:602:			//$titlestr = $current_module_strings['LBL_ALL_OPPORTUNITIES'].$current_user->currency_symbol.$total;
modules/Potentials/Charts.php:634:			$valueproc =& Image_Graph::factory('Image_Graph_DataPreprocessor_Formatted', $current_user->currency_symbol."%d");
modules/Potentials/Charts.php:654:			$subtitle = $current_module_strings['LBL_OPP_SIZE'].$current_user->currency_symbol.$current_module_strings['LBL_OPP_SIZE_VALUE']; 
modules/Potentials/Charts.php:776:						$amount = convertFromMasterCurrency(preg_replace('/[^0-9]/', '', floor($record->column_fields['amount'])),$current_user->conv_rate);
modules/Potentials/Charts.php:899:			$titlestr = $current_module_strings['LBL_TOTAL_PIPELINE'].$current_user->currency_symbol.$total.$app_strings['LBL_THOUSANDS_SYMBOL'];
modules/Potentials/Charts.php:900:			//$titlestr = $current_module_strings['LBL_TOTAL_PIPELINE'].$current_user->currency_symbol.$total;
modules/Potentials/Charts.php:935:			$valueproc =& Image_Graph::factory('Image_Graph_DataPreprocessor_Formatted', $current_user->currency_symbol."%d");
modules/Potentials/Charts.php:956:			$subtitle .= $current_module_strings['LBL_OPP_SIZE'].$current_user->currency_symbol.$current_module_strings['LBL_OPP_SIZE_VALUE']; 
modules/Potentials/Charts.php:1039:						$amount = convertFromMasterCurrency(preg_replace('/[^0-9]/', '', floor($record->column_fields['amount'])),$current_user->conv_rate);
modules/Potentials/Charts.php:1145:			$titlestr = $current_module_strings['LBL_TOTAL_PIPELINE'].$current_user->currency_symbol.$total.$app_strings['LBL_THOUSANDS_SYMBOL'];
modules/Potentials/Charts.php:1146:			//$titlestr = $current_module_strings['LBL_TOTAL_PIPELINE'].$current_user->currency_symbol.$total;
modules/Potentials/Charts.php:1151:			$valueproc =& Image_Graph::factory('Image_Graph_DataPreprocessor_Formatted', $current_user->currency_symbol."%d");
modules/Potentials/Charts.php:1169:			$subtitle = $current_module_strings['LBL_OPP_SIZE'].$current_user->currency_symbol.$current_module_strings['LBL_OPP_SIZE_VALUE'];
modules/Potentials/DetailView.php:130:$focus->markAsViewed($current_user->id);
modules/Potentials/ListViewTop.php:45:	$where = "AND vtiger_potential.potentialid > 0 AND vtiger_potential.sales_stage not in ('Closed Won','Closed Lost','".$current_module_strings['Closed Won']."','".$current_module_strings['Closed Lost']."') AND vtiger_crmentity.smownerid='".$current_user->id."' AND vtiger_potential.amount > 0";
modules/Potentials/ListViewTop.php:49:	$currencyid=fetchCurrency($current_user->id);
modules/Potentials/ListViewTop.php:114:            'value' => getFullNameFromArray('Users', $current_user->column_fields),
modules/Potentials/Potentials.php:115:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Potentials/Potentials.php:116:	        require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Potentials/Potentials.php:285:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Potentials/Potentials.php:290:				if(getFieldVisibilityPermission('Events',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Potentials/Potentials.php:412:		$amount_access = (getFieldVisibilityPermission('Potentials', $current_user->id, 'amount') != '0')? 1 : 0;
modules/Potentials/Potentials.php:413:		$probability_access = (getFieldVisibilityPermission('Potentials', $current_user->id, 'probability') != '0')? 1 : 0;
modules/Potentials/Potentials.php:499:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'potential_id', 'readwrite') == '0') {
modules/Potentials/Potentials.php:556:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'potential_id', 'readwrite') == '0') {
modules/PP/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/PP/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/PP/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/PP/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/PP/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/PP/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/PP/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/PP/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/PP/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PP/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PP/PP.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/PP/PP.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/PP/PP.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/PP/PP.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/PP/PP.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/PP/PP.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/PP/PP.php:289:		if($record_user != $current_user->id){
modules/PP/PP.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PP/PP.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PriceBooks/DetailView.php:110:$focus->markAsViewed($current_user->id);
modules/Products/AddProductsToPriceBook.php:19:if ($currency_id == null) $currency_id = fetchCurrency($current_user->id);
modules/Products/AddProductsToPriceBook.php:26:if(getFieldVisibilityPermission('Products',$current_user->id,'unit_price') != '0'){
modules/Products/AddProductsToPriceBook.php:122:if(getFieldVisibilityPermission('Products', $current_user->id, 'productcode') == '0')
modules/Products/AddProductsToPriceBook.php:124:if(getFieldVisibilityPermission('Products', $current_user->id, 'unit_price') == '0')
modules/Products/AddProductsToPriceBook.php:164:		if(getFieldVisibilityPermission('Products', $current_user->id, 'productcode') == '0')
modules/Products/AddProductsToPriceBook.php:166:		if(getFieldVisibilityPermission('Products', $current_user->id, 'unit_price') == '0')
modules/Products/AddProductToPriceBooks.php:26:if(getFieldVisibilityPermission($currentModule,$current_user->id,'unit_price') != '0'){
modules/Products/CallRelatedList.php:30:		$product_base_currency = fetchCurrency($current_user->id);
modules/Products/DetailView.php:128:$focus->markAsViewed($current_user->id);
modules/Products/EditView.php:41:	$product_base_currency = fetchCurrency($current_user->id);
modules/Products/Products.php:512:		if($actions && getFieldVisibilityPermission($related_module, $current_user->id, 'product_id','readwrite') == '0') {
modules/Products/Products.php:1167:				AND vtiger_productcurrencyrel.currencyid = ". $current_user->currency_id . "
modules/Products/Save.php:23:$currencyid=fetchCurrency($current_user->id);
modules/Project/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/Project/Project.php:185:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Project/Project.php:186:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Project/Project.php:194:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN
modules/Project/Project.php:204:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Project/Project.php:217:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ProjectMilestone/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/ProjectMilestone/ProjectMilestone.php:181:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ProjectMilestone/ProjectMilestone.php:182:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ProjectMilestone/ProjectMilestone.php:190:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN
modules/ProjectMilestone/ProjectMilestone.php:200:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ProjectMilestone/ProjectMilestone.php:213:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/ProjectTask/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/ProjectTask/ProjectTask.php:188:        require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ProjectTask/ProjectTask.php:189:        require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ProjectTask/ProjectTask.php:197:                $sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN
modules/ProjectTask/ProjectTask.php:207:                        WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ProjectTask/ProjectTask.php:220:                            WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Proposal/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/Proposal/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Proposal/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Proposal/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Proposal/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Proposal/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Proposal/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Proposal/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/Proposal/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Proposal/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Proposal/Proposal.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Proposal/Proposal.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Proposal/Proposal.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/Proposal/Proposal.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Proposal/Proposal.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Proposal/Proposal.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/Proposal/Proposal.php:289:		if($record_user != $current_user->id){
modules/Proposal/Proposal.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Proposal/Proposal.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/PurchaseOrder/DetailView.php:132:$focus->markAsViewed($current_user->id);
modules/PurchaseOrder/EditView.php:38:$currencyid=fetchCurrency($current_user->id);
modules/PurchaseOrder/ListTopPurchaseOrder.php:171:            'value' => getFullNameFromArray('Users', $current_user->column_fields),
modules/PurchaseOrder/PurchaseOrder.php:173:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/PurchaseOrder/PurchaseOrder.php:255:		$postatus_access = (getFieldVisibilityPermission('PurchaseOrder', $current_user->id, 'postatus') != '0')? 1 : 0;
modules/Quotes/DetailView.php:140:$focus->markAsViewed($current_user->id);
modules/Quotes/EditView.php:39:$currencyid=fetchCurrency($current_user->id);
modules/Quotes/ListTopQuotes.php:201:            'value' => getFullNameFromArray('Users', $current_user->column_fields),
modules/Quotes/Quotes.php:198:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/Quotes/Quotes.php:304:		$quotestage_access = (getFieldVisibilityPermission('Quotes', $current_user->id, 'quotestage') != '0')? 1 : 0;
modules/RecycleBin/ListView.php:24:require("user_privileges/user_privileges_".$current_user->id.".php");
modules/Reports/Delete.php:15:require("user_privileges/user_privileges_".$current_user->id.".php");
modules/Reports/Delete.php:33:		if($is_admin==true || in_array($owner,$subordinate_users) || $owner==$current_user->id){
modules/Reports/DuplicateReport.php:32:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/DuplicateReport.php:71:				$owner = $current_user->id;
modules/Reports/NewReport1.php:91:$list_report_form->assign('USER_DATE_FORMAT',$current_user->date_format);
modules/Reports/NewReport1.php:93:if(isset($current_user->currency_grouping_separator) && $current_user->currency_grouping_separator == '') {
modules/Reports/NewReport1.php:96:	$list_report_form->assign('USER_CURRENCY_SEPARATOR', html_entity_decode($current_user->currency_grouping_separator, ENT_QUOTES, $default_charset));
modules/Reports/NewReport1.php:98:if(isset($current_user->currency_decimal_separator) && $current_user->currency_decimal_separator == '') {
modules/Reports/NewReport1.php:101:	$list_report_form->assign('USER_DECIMAL_FORMAT', html_entity_decode($current_user->currency_decimal_separator, ENT_QUOTES, $default_charset));
modules/Reports/ReportFilters.php:35:$report_std_filter->assign("DATEFORMAT",$current_user->date_format);
modules/Reports/ReportRun.php:103:			require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/ReportRun.php:1546:						AND vtiger_productcurrencyrel.currencyid = ". $current_user->currency_id . "
modules/Reports/ReportRun.php:1871:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/ReportRun.php:2226:												$col_header .= " (".$app_strings['LBL_IN']." ".$current_user->currency_symbol.")";
modules/Reports/ReportRun.php:2339:							$col_header .= " (".$app_strings['LBL_IN']." ".$current_user->currency_symbol.")";
modules/Reports/ReportRun.php:2611:							$col_header .= " (".$app_strings['LBL_IN']." ".$current_user->currency_symbol.")";
modules/Reports/ReportRun.php:2869:        	$curr_symb = " (".$app_strings['LBL_IN']." ".$current_user->currency_symbol.")";
modules/Reports/ReportRun.php:2891:		$roleid=$current_user->roleid;
modules/Reports/Reports.php:120:			$cachedInfo = VTCacheUtils::lookupReport_Info($current_user->id, $reportid);
modules/Reports/Reports.php:129:				require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/Reports.php:131:				$userGroups->getAllUserGroups($current_user->id);
modules/Reports/Reports.php:141:					array_push($params, $current_user->id);
modules/Reports/Reports.php:142:					array_push($params, $current_user->id);
modules/Reports/Reports.php:160:						$current_user->id, $reportid, $reportmodulesrow["primarymodule"],
modules/Reports/Reports.php:168:				$cachedInfo = VTCacheUtils::lookupReport_Info($current_user->id, $reportid);
modules/Reports/Reports.php:178:				if($is_admin==true || in_array($cachedInfo["owner"],$subordinate_users) || $cachedInfo["owner"]==$current_user->id)
modules/Reports/Reports.php:428:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/Reports.php:431:		$userGroups->getAllUserGroups($current_user->id);
modules/Reports/Reports.php:441:			array_push($params, $current_user->id);
modules/Reports/Reports.php:442:			array_push($params, $current_user->id);
modules/Reports/Reports.php:465:				if($is_admin==true || in_array($report["owner"],$subordinate_users) || $report["owner"]==$current_user->id)
modules/Reports/Reports.php:598:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/Reports.php:769:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/Reports.php:1225:				require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/Reports.php:1442:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/ReportSharing.php:35:$report_std_filter->assign("DATEFORMAT",$current_user->date_format);
modules/Reports/ReportSharing.php:38:$roleid = $current_user->column_fields['roleid'];
modules/Reports/ReportSharing.php:45:	if($userid!=$current_user->id){
modules/Reports/Save.php:152:				$ireportparams = array($genQueryId, $folderid, $reportname, $reportdescription, $reporttype, $genQueryId,'CUSTOM',$current_user->id,$sharetype);
modules/Reports/SaveAndRun.php:47:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Reports/SaveAndRun.php:164:		$list_report_form->assign("DATEFORMAT",$current_user->date_format);
modules/Reports/StandardFilter.php:33:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SalesAgreement/DetailView.php:105:$focus->markAsViewed($current_user->id);
modules/SalesAgreement/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SalesAgreement/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SalesAgreement/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SalesAgreement/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SalesAgreement/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SalesAgreement/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SalesAgreement/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/SalesAgreement/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SalesAgreement/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SalesAgreement/SalesAgreement.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SalesAgreement/SalesAgreement.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SalesAgreement/SalesAgreement.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SalesAgreement/SalesAgreement.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SalesAgreement/SalesAgreement.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SalesAgreement/SalesAgreement.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SalesAgreement/SalesAgreement.php:289:		if($record_user != $current_user->id){
modules/SalesAgreement/SalesAgreement.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SalesAgreement/SalesAgreement.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SalesOrder/DetailView.php:136:$focus->markAsViewed($current_user->id);
modules/SalesOrder/EditView.php:40:$currencyid = fetchCurrency($current_user->id);
modules/SalesOrder/ListTopSalesOrder.php:171:            'value' => getFullNameFromArray('Users', $current_user->column_fields),
modules/SalesOrder/SalesOrder.php:174:				if(getFieldVisibilityPermission('Calendar',$current_user->id,'parent_id', 'readwrite') == '0') {
modules/SalesOrder/SalesOrder.php:293:		$sostatus_access = (getFieldVisibilityPermission('SalesOrder', $current_user->id, 'sostatus') != '0')? 1 : 0;
modules/ServiceContracts/DetailView.php:105:$focus->markAsViewed($current_user->id);
modules/ServiceContracts/ServiceContracts.php:185:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/ServiceContracts/ServiceContracts.php:186:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/ServiceContracts/ServiceContracts.php:194:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN
modules/ServiceContracts/ServiceContracts.php:204:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/ServiceContracts/ServiceContracts.php:217:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Services/AddServicesToPriceBook.php:20:if ($currency_id == null) $currency_id = fetchCurrency($current_user->id);
modules/Services/AddServicesToPriceBook.php:27:if(getFieldVisibilityPermission('Services',$current_user->id,'unit_price') != '0'){
modules/Services/AddServicesToPriceBook.php:122:if(getFieldVisibilityPermission('Services', $current_user->id, 'unit_price') == '0')
modules/Services/AddServicesToPriceBook.php:162:		if(getFieldVisibilityPermission('Services', $current_user->id, 'unit_price') == '0')
modules/Services/AddServiceToPriceBooks.php:25:if(getFieldVisibilityPermission($currentModule,$current_user->id,'unit_price') != '0'){
modules/Services/CallRelatedList.php:33:		$service_base_currency = fetchCurrency($current_user->id);
modules/Services/DetailView.php:117:$focus->markAsViewed($current_user->id);
modules/Services/EditView.php:32:	$service_base_currency = fetchCurrency($current_user->id);
modules/Services/Save.php:23:$currencyid=fetchCurrency($current_user->id);
modules/Services/Services.php:282:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Services/Services.php:283:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/Services/Services.php:291:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN
modules/Services/Services.php:301:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/Services/Services.php:314:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/Services/Services.php:814:		if(getFieldVisibilityPermission('Services', $current_user->id, 'unit_price') == '0')
modules/Services/Services.php:834:			if(getFieldVisibilityPermission('Services', $current_user->id, 'unit_price') == '0')
modules/Services/Services.php:928:					AND vtiger_productcurrencyrel.currencyid = ". $current_user->currency_id . "
modules/Services/Services.php:944:						(CASE WHEN (vtiger_service.currency_id = " . $current_user->currency_id . " ) THEN vtiger_service.unit_price
modules/Services/Services.php:946:							ELSE (vtiger_service.unit_price / vtiger_currency_info.conversion_rate) * ". $current_user->conv_rate . " END
modules/Services/Services.php:951:				AND vtiger_productcurrencyrel.currencyid = ". $current_user->currency_id . "
modules/Settings/AddCustomFieldToDB.php:266:				$roleid=$current_user->roleid;
modules/Settings/Announcements.php:20:$result=$adb->pquery($query, array($current_user->id));
modules/Settings/Forms.php:119:$user_id = $current_user->id;
modules/Settings/Forms.php:239:$user_id = $current_user->id;
modules/Settings/LayoutBlockList.php:968:					$roleid=$current_user->roleid;
modules/Settings/LayoutBlockList.php:1204:					$roleid=$current_user->roleid;
modules/Settings/ListProfiles.php:48:        $current_profile = fetchUserProfileId($current_user->id);
modules/Settings/MailScanner/core/MailScannerAction.php:198:		$current_user->id = 1;
modules/Settings/MailScanner/core/MailScannerAction.php:205:		$ticket->column_fields['assigned_user_id'] = $current_user->id;
modules/Settings/RoleDetailView.php:42:		if(isset($roleUserArr[$userid]) && !$current_user->isSupreme){
modules/Settings/RoleDetailView.php:70:	$current_role = fetchUserRole($current_user->id);
modules/Settings/Save.php:128:	$to_email = getUserEmailId('id',$current_user->id);
modules/Settings/Save.php:131:	$description = 'Dear '.$current_user->user_name.', <br><br><b> This is a test mail sent to confirm if a mail is actually being sent through the smtp server that you have configured. </b><br>Feel free to delete this mail.<br><br>Thanks  and  Regards,<br> Team vTiger <br><br>';
modules/Settings/Save.php:134:		$mail_status = send_mail('Users',$to_email,$current_user->user_name,$from_email,$subject,$description);
modules/Settings/SettingsAjax.php:25:    $is_announce=$adb->pquery($sql, array($current_user->id));
modules/Settings/SettingsAjax.php:28:		$params = array($announcement, $adb->formatDate($date_var, true), 'announcement', $current_user->id);
modules/Settings/SettingsAjax.php:31:		$params = array($current_user->id,$announcement,'announcement',$adb->formatDate($date_var, true));
modules/SHAccounts/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/SHAccounts/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHAccounts/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHAccounts/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHAccounts/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHAccounts/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHAccounts/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHAccounts/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/SHAccounts/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHAccounts/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHAccounts/SHAccounts.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHAccounts/SHAccounts.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHAccounts/SHAccounts.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHAccounts/SHAccounts.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHAccounts/SHAccounts.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHAccounts/SHAccounts.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHAccounts/SHAccounts.php:289:		if($record_user != $current_user->id){
modules/SHAccounts/SHAccounts.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHAccounts/SHAccounts.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHContacts/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/SHContacts/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHContacts/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHContacts/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHContacts/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHContacts/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHContacts/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHContacts/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/SHContacts/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHContacts/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHContacts/SHContacts.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHContacts/SHContacts.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHContacts/SHContacts.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHContacts/SHContacts.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHContacts/SHContacts.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHContacts/SHContacts.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHContacts/SHContacts.php:289:		if($record_user != $current_user->id){
modules/SHContacts/SHContacts.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHContacts/SHContacts.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHExpenses/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/SHExpenses/DetailView.php:109:if ( $current_user->roleid == ADMIN && $focus->column_fields['expense_status'] == 'Pending' ) {
modules/SHExpenses/DetailView.php:113:if ( $current_user->roleid != ADMIN && $focus->column_fields['expense_status'] == 'Approved' ) {
modules/SHExpenses/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHExpenses/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHExpenses/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHExpenses/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHExpenses/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHExpenses/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHExpenses/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/SHExpenses/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHExpenses/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHExpenses/SHExpenses.php:1:<?php/*+********************************************************************************** * The contents of this file are subject to the vtiger CRM Public License Version 1.0 * ("License"); You may not use this file except in compliance with the License * The Original Code is:  vtiger CRM Open Source * The Initial Developer of the Original Code is vtiger. * Portions created by vtiger are Copyright (C) vtiger. * All Rights Reserved. ************************************************************************************/require_once('data/CRMEntity.php');require_once('data/Tracker.php');class SHExpenses extends CRMEntity {	var $db, $log; // Used in class functions of CRMEntity	var $table_name = 'vtiger_shexpenses';	var $table_index= 'shexpensesid';	var $column_fields = Array();	/** Indicator if this is a custom module or standard module */	var $IsCustomModule = true;	/**	 * Mandatory table for supporting custom fields.	 */	var $customFieldTable = Array('vtiger_shexpensescf', 'shexpensesid');	var $related_tables = Array ('vtiger_shexpensescf' => Array('shexpensesid'));	/**	 * Mandatory for Saving, Include tables related to this module.	 */	var $tab_name = Array('vtiger_crmentity', 'vtiger_shexpenses', 'vtiger_shexpensescf');	/**	 * Mandatory for Saving, Include tablename and tablekey columnname here.	 */	var $tab_name_index = Array(		'vtiger_crmentity' => 'crmid',		'vtiger_shexpenses'   => 'shexpensesid',	    'vtiger_shexpensescf' => 'shexpensesid');		/**	 * Mandatory for Listing (Related listview)	 */	var $list_fields = Array (		/* Format: Field Label => Array(tablename, columnname) */		// tablename should not have prefix 'vtiger_'		'NTP No' => Array('shexpenses','expense_no'),'Cost' => Array('shexpenses','cost'),'Other' => Array('shexpenses','other'),'Status' => Array('shexpenses','expense_status')	);	var $list_fields_name = Array(		/* Format: Field Label => fieldname */		'NTP No' => 'expense_no','Cost' => 'cost','Other' => 'other','Status' => 'expense_status'	);	// Make the field link to detail view from list view (Fieldname)	var $list_link_field = 'expense_no';	// For Popup listview and UI type support	var $search_fields = Array(		/* Format: Field Label => Array(tablename, columnname) */		// tablename should not have prefix 'vtiger_'		'NTP No' => Array('shexpenses','expense_no'),'Cost' => Array('shexpenses','cost'),'Other' => Array('shexpenses','other'),'Status' => Array('shexpenses','expense_status')	);	var $search_fields_name = Array(		/* Format: Field Label => fieldname */		'NTP No' => 'expense_no','Cost' => 'cost','Other' => 'other','Status' => 'expense_status'	);	// For Popup window record selection	var $popup_fields = Array('expense_no');	// Placeholder for sort fields - All the fields will be initialized for Sorting through initSortFields	var $sortby_fields = Array();	// For Alphabetical search	var $def_basicsearch_col = 'expense_no';	// Column value to use on detail view record text display	var $def_detailview_recname = 'expense_no';	// Required Information for enabling Import feature	var $required_fields = Array('expense_no'=>1);	// Callback function list during Importing	var $special_functions = Array('set_import_assigned_user');	var $default_order_by = 'expense_no';	var $default_sort_order='ASC';	// Used when enabling/disabling the mandatory fields for the module.	// Refers to vtiger_field.fieldname values.	var $mandatory_fields = Array('createdtime', 'modifiedtime', 'expense_no');	function __construct() {		global $log, $currentModule;		$this->column_fields = getColumnFields($currentModule);		$this->db = PearDatabase::getInstance();		$this->log = $log;	}	function getSortOrder() {		global $currentModule;		$sortorder = $this->default_sort_order;		if($_REQUEST['sorder']) $sortorder = $this->db->sql_escape_string($_REQUEST['sorder']);		else if($_SESSION[$currentModule.'_Sort_Order']) 			$sortorder = $_SESSION[$currentModule.'_Sort_Order'];		return $sortorder;	}	function getOrderBy() {		global $currentModule;				$use_default_order_by = '';				if(PerformancePrefs::getBoolean('LISTVIEW_DEFAULT_SORTING', true)) {			$use_default_order_by = $this->default_order_by;		}				$orderby = $use_default_order_by;		if($_REQUEST['order_by']) $orderby = $this->db->sql_escape_string($_REQUEST['order_by']);		else if($_SESSION[$currentModule.'_Order_By'])			$orderby = $_SESSION[$currentModule.'_Order_By'];		return $orderby;	}	function save_module($module) {		$this->insertIntoAttachment($this->id,$module);	}	function insertIntoAttachment($id,$module)	{		global $log, $adb;		$log->debug("Entering into insertIntoAttachment($id,$module) method.");		$file_saved = false;		//This is to added to store the existing attachment id of the contact where we should delete this when we give new image		$old_attachmentid = $adb->query_result($adb->pquery("select vtiger_crmentity.crmid from vtiger_seattachmentsrel inner join vtiger_crmentity on vtiger_crmentity.crmid=vtiger_seattachmentsrel.attachmentsid where  vtiger_seattachmentsrel.crmid=?", array($id)),0,'crmid');		foreach($_FILES as $fileindex => $files)		{			if($files['name'] != '' && $files['size'] > 0)			{				$files['original_name'] = vtlib_purify($_REQUEST[$fileindex.'_hidden']);				$file_saved = $this->uploadAndSaveFile($id,$module,$files);			}		}		//This is to handle the delete image for contacts		if($file_saved)		{			if($old_attachmentid != '')			{				$setype = $adb->query_result($adb->pquery("select setype from vtiger_crmentity where crmid=?", array($old_attachmentid)),0,'setype');					$del_res1 = $adb->pquery("delete from vtiger_attachments where attachmentsid=?", array($old_attachmentid));					$del_res2 = $adb->pquery("delete from vtiger_seattachmentsrel where attachmentsid=?", array($old_attachmentid));			}		}		$log->debug("Exiting from insertIntoAttachment($id,$module) method.");	}	/**	 * Return query to use based on given modulename, fieldname	 * Useful to handle specific case handling for Popup	 */	function getQueryByModuleField($module, $fieldname, $srcrecord, $query='') {		// $srcrecord could be empty	}	/**	 * Get list view query (send more WHERE clause condition if required)	 */	function getListQuery($module, $usewhere='') {		$query = "SELECT vtiger_crmentity.*, $this->table_name.*";				// Keep track of tables joined to avoid duplicates		$joinedTables = array();		// Select Custom Field Table Columns if present		if(!empty($this->customFieldTable)) $query .= ", " . $this->customFieldTable[0] . ".* ";		$query .= " FROM $this->table_name";		$query .= "	INNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = $this->table_name.$this->table_index";		$joinedTables[] = $this->table_name;		$joinedTables[] = 'vtiger_crmentity';				// Consider custom table join as well.		if(!empty($this->customFieldTable)) {			$query .= " INNER JOIN ".$this->customFieldTable[0]." ON ".$this->customFieldTable[0].'.'.$this->customFieldTable[1] .				      " = $this->table_name.$this->table_index";			$joinedTables[] = $this->customFieldTable[0]; 		}		$query .= " LEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid";		$query .= " LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid";		$joinedTables[] = 'vtiger_users';		$joinedTables[] = 'vtiger_groups';				$linkedModulesQuery = $this->db->pquery("SELECT distinct fieldname, columnname, relmodule FROM vtiger_field" .				" INNER JOIN vtiger_fieldmodulerel ON vtiger_fieldmodulerel.fieldid = vtiger_field.fieldid" .				" WHERE uitype='10' AND vtiger_fieldmodulerel.module=?", array($module));		$linkedFieldsCount = $this->db->num_rows($linkedModulesQuery);				for($i=0; $i<$linkedFieldsCount; $i++) {			$related_module = $this->db->query_result($linkedModulesQuery, $i, 'relmodule');			$fieldname = $this->db->query_result($linkedModulesQuery, $i, 'fieldname');			$columnname = $this->db->query_result($linkedModulesQuery, $i, 'columnname');						$other =  CRMEntity::getInstance($related_module);			vtlib_setup_modulevars($related_module, $other);						if(!in_array($other->table_name, $joinedTables)) {				$query .= " LEFT JOIN $other->table_name ON $other->table_name.$other->table_index = $this->table_name.$columnname";				$joinedTables[] = $other->table_name;			}		}		global $current_user;		$query .= $this->getNonAdminAccessControlQuery($module,$current_user);		$query .= "	WHERE vtiger_crmentity.deleted = 0 ".$usewhere;		return $query;	}	/**	 * Apply security restriction (sharing privilege) query part for List view.	 */	function getListViewSecurityParameter($module) {		global $current_user;		require('user_privileges/user_privileges_'.$current_user->id.'.php');		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');		$sec_query = '';		$tabid = getTabid($module);		if($is_admin==false && $profileGlobalPermission[1] == 1 && $profileGlobalPermission[2] == 1 			&& $defaultOrgSharingPermission[$tabid] == 3) {				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 					(						SELECT vtiger_user2role.userid FROM vtiger_user2role 						INNER JOIN vtiger_users ON vtiger_users.id=vtiger_user2role.userid 						INNER JOIN vtiger_role ON vtiger_role.roleid=vtiger_user2role.roleid 						WHERE vtiger_role.parentrole LIKE '".$current_user_parent_role_seq."::%'					) 					OR vtiger_crmentity.smownerid IN 					(						SELECT shareduserid FROM vtiger_tmp_read_user_sharing_per 						WHERE userid=".$current_user->id." AND tabid=".$tabid."					) 					OR 						(";							// Build the query based on the group association of current user.					if(sizeof($current_user_groups) > 0) {						$sec_query .= " vtiger_groups.groupid IN (". implode(",", $current_user_groups) .") OR ";					}					$sec_query .= " vtiger_groups.groupid IN 						(							SELECT vtiger_tmp_read_group_sharing_per.sharedgroupid 							FROM vtiger_tmp_read_group_sharing_per							WHERE userid=".$current_user->id." and tabid=".$tabid."						)";				$sec_query .= ")				)";		}		return $sec_query;	}	/**	 * Create query to export the records.	 */	function create_export_query($where)	{		global $current_user;		$thismodule = $_REQUEST['module'];				include("include/utils/ExportUtils.php");		//To get the Permitted fields query and the permitted fields list		$sql = getPermittedFieldsQuery($thismodule, "detail_view");				$fields_list = getFieldsListFromQuery($sql);		$query = "SELECT $fields_list, vtiger_users.user_name AS user_name 					FROM vtiger_crmentity INNER JOIN $this->table_name ON vtiger_crmentity.crmid=$this->table_name.$this->table_index";		if(!empty($this->customFieldTable)) {			$query .= " INNER JOIN ".$this->customFieldTable[0]." ON ".$this->customFieldTable[0].'.'.$this->customFieldTable[1] .				      " = $this->table_name.$this->table_index"; 		}		$query .= " LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid";		$query .= " LEFT JOIN vtiger_users ON vtiger_crmentity.smownerid = vtiger_users.id and vtiger_users.status='Active'";				$linkedModulesQuery = $this->db->pquery("SELECT distinct fieldname, columnname, relmodule FROM vtiger_field" .				" INNER JOIN vtiger_fieldmodulerel ON vtiger_fieldmodulerel.fieldid = vtiger_field.fieldid" .				" WHERE uitype='10' AND vtiger_fieldmodulerel.module=?", array($thismodule));		$linkedFieldsCount = $this->db->num_rows($linkedModulesQuery);		for($i=0; $i<$linkedFieldsCount; $i++) {			$related_module = $this->db->query_result($linkedModulesQuery, $i, 'relmodule');			$fieldname = $this->db->query_result($linkedModulesQuery, $i, 'fieldname');			$columnname = $this->db->query_result($linkedModulesQuery, $i, 'columnname');						$other = CRMEntity::getInstance($related_module);			vtlib_setup_modulevars($related_module, $other);						$query .= " LEFT JOIN $other->table_name ON $other->table_name.$other->table_index = $this->table_name.$columnname";		}		$query .= $this->getNonAdminAccessControlQuery($thismodule,$current_user);		$where_auto = " vtiger_crmentity.deleted=0";		if($where != '') $query .= " WHERE ($where) AND $where_auto";		else $query .= " WHERE $where_auto";		return $query;	}	/**	 * Initialize this instance for importing.	 */	function initImport($module) {		$this->db = PearDatabase::getInstance();		$this->initImportableFields($module);	}	/**	 * Create list query to be shown at the last step of the import.	 * Called From: modules/Import/UserLastImport.php	 */	function create_import_query($module) {		global $current_user;		$query = "SELECT vtiger_crmentity.crmid, case when (vtiger_users.user_name not like '') then vtiger_users.user_name else vtiger_groups.groupname end as user_name, $this->table_name.* FROM $this->table_name			INNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = $this->table_name.$this->table_index			LEFT JOIN vtiger_users_last_import ON vtiger_users_last_import.bean_id=vtiger_crmentity.crmid			LEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid			LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'			AND vtiger_users_last_import.bean_type='$module'			AND vtiger_users_last_import.deleted=0";		return $query;	}	/**	 * Delete the last imported records.	 */	function undo_import($module, $user_id) {		global $adb;		$count = 0;		$query1 = "select bean_id from vtiger_users_last_import where assigned_user_id=? AND bean_type='$module' AND deleted=0";		$result1 = $adb->pquery($query1, array($user_id)) or die("Error getting last import for undo: ".mysql_error()); 		while ( $row1 = $adb->fetchByAssoc($result1))		{			$query2 = "update vtiger_crmentity set deleted=1 where crmid=?";			$result2 = $adb->pquery($query2, array($row1['bean_id'])) or die("Error undoing last import: ".mysql_error()); 			$count++;					}		return $count;	}		/**	 * Transform the value while exporting	 */	function transform_export_value($key, $value) {		return parent::transform_export_value($key, $value);	}	/**	 * Function which will set the assigned user id for import record.	 */	function set_import_assigned_user()	{		global $current_user, $adb;		$record_user = $this->column_fields["assigned_user_id"];				if($record_user != $current_user->id){			$sqlresult = $adb->pquery("select id from vtiger_users where id = ? union select groupid as id from vtiger_groups where groupid = ?", array($record_user, $record_user));			if($this->db->num_rows($sqlresult)!= 1) {				$this->column_fields["assigned_user_id"] = $current_user->id;			} else {							$row = $adb->fetchByAssoc($sqlresult, -1, false);				if (isset($row['id']) && $row['id'] != -1) {					$this->column_fields["assigned_user_id"] = $row['id'];				} else {					$this->column_fields["assigned_user_id"] = $current_user->id;				}			}		}	}		/** 	 * Function which will give the basic query to find duplicates	 */	function getDuplicatesQuery($module,$table_cols,$field_values,$ui_type_arr,$select_cols='') {		$select_clause = "SELECT ". $this->table_name .".".$this->table_index ." AS recordid, vtiger_users_last_import.deleted,".$table_cols;		// Select Custom Field Table Columns if present		if(isset($this->customFieldTable)) $query .= ", " . $this->customFieldTable[0] . ".* ";		$from_clause = " FROM $this->table_name";		$from_clause .= "	INNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = $this->table_name.$this->table_index";		// Consider custom table join as well.		if(isset($this->customFieldTable)) {			$from_clause .= " INNER JOIN ".$this->customFieldTable[0]." ON ".$this->customFieldTable[0].'.'.$this->customFieldTable[1] .				      " = $this->table_name.$this->table_index"; 		}		$from_clause .= " LEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid						LEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid";				$where_clause = "	WHERE vtiger_crmentity.deleted = 0";		$where_clause .= $this->getListViewSecurityParameter($module);							if (isset($select_cols) && trim($select_cols) != '') {			$sub_query = "SELECT $select_cols FROM  $this->table_name AS t " .				" INNER JOIN vtiger_crmentity AS crm ON crm.crmid = t.".$this->table_index;			// Consider custom table join as well.			if(isset($this->customFieldTable)) {				$sub_query .= " LEFT JOIN ".$this->customFieldTable[0]." tcf ON tcf.".$this->customFieldTable[1]." = t.$this->table_index";			}			$sub_query .= " WHERE crm.deleted=0 GROUP BY $select_cols HAVING COUNT(*)>1";			} else {			$sub_query = "SELECT $table_cols $from_clause $where_clause GROUP BY $table_cols HAVING COUNT(*)>1";		}							$query = $select_clause . $from_clause .					" LEFT JOIN vtiger_users_last_import ON vtiger_users_last_import.bean_id=" . $this->table_name .".".$this->table_index .					" INNER JOIN (" . $sub_query . ") AS temp ON ".get_on_clause($field_values,$ui_type_arr,$module) .					$where_clause .					" ORDER BY $table_cols,". $this->table_name .".".$this->table_index ." ASC";							return $query;			}	/**	 * Invoked when special actions are performed on the module.	 * @param String Module name	 * @param String Event Type (module.postinstall, module.disabled, module.enabled, module.preuninstall)	 */	function vtlib_handler($modulename, $event_type) {		if($event_type == 'module.postinstall') {			// TODO Handle post installation actions		} else if($event_type == 'module.disabled') {			// TODO Handle actions when this module is disabled.		} else if($event_type == 'module.enabled') {			// TODO Handle actions when this module is enabled.		} else if($event_type == 'module.preuninstall') {			// TODO Handle actions when this module is about to be deleted.		} else if($event_type == 'module.preupdate') {			// TODO Handle actions before this module is updated.		} else if($event_type == 'module.postupdate') {			// TODO Handle actions after this module is updated.		}	}	/** 	 * Handle saving related module information.	 * NOTE: This function has been added to CRMEntity (base class).	 * You can override the behavior by re-defining it here.	 */	// function save_related_module($module, $crmid, $with_module, $with_crmid) { }		/**	 * Handle deleting related module information.	 * NOTE: This function has been added to CRMEntity (base class).	 * You can override the behavior by re-defining it here.	 */	//function delete_related_module($module, $crmid, $with_module, $with_crmid) { }	/**	 * Handle getting related list information.	 * NOTE: This function has been added to CRMEntity (base class).	 * You can override the behavior by re-defining it here.	 */	//function get_related_list($id, $cur_tab_id, $rel_tab_id, $actions=false) { }	/**	 * Handle getting dependents list information.	 * NOTE: This function has been added to CRMEntity (base class).	 * You can override the behavior by re-defining it here.	 */	//function get_dependents_list($id, $cur_tab_id, $rel_tab_id, $actions=false) { }}?>
modules/SHReports/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/SHReports/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHReports/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHReports/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHReports/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHReports/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHReports/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHReports/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/SHReports/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHReports/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHReports/SHReports.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHReports/SHReports.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHReports/SHReports.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHReports/SHReports.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHReports/SHReports.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHReports/SHReports.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHReports/SHReports.php:289:		if($record_user != $current_user->id){
modules/SHReports/SHReports.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHReports/SHReports.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHSupplier/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/SHSupplier/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHSupplier/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHSupplier/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHSupplier/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHSupplier/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHSupplier/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHSupplier/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/SHSupplier/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHSupplier/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHSupplier/SHSupplier.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SHSupplier/SHSupplier.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SHSupplier/SHSupplier.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SHSupplier/SHSupplier.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SHSupplier/SHSupplier.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SHSupplier/SHSupplier.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/SHSupplier/SHSupplier.php:289:		if($record_user != $current_user->id){
modules/SHSupplier/SHSupplier.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SHSupplier/SHSupplier.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/SMSNotifier/DetailView.php:110:$focus->markAsViewed($current_user->id);
modules/SMSNotifier/SMSNotifier.php:40:				$ownerid = $current_user->id;
modules/SMSNotifier/SMSNotifier.php:87:			require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SMSNotifier/SMSNotifierBase.php:186:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SMSNotifier/SMSNotifierBase.php:187:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SMSNotifier/SMSNotifierBase.php:195:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/SMSNotifier/SMSNotifierBase.php:205:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/SMSNotifier/SMSNotifierBase.php:218:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/SMSNotifier/SMSNotifierBase.php:275:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/SMSNotifier/SMSNotifierBase.php:276:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/SMSNotifier/SMSNotifierSelectWizard.php:41:			$checkFieldPermission = getFieldVisibilityPermission( $sourcemodule, $current_user->id, $resultrow['fieldname'] );
modules/SMSNotifier/SMSNotifierSend.php:47:	SMSNotifier::sendsms($message, $tonumbers, $current_user->id, $recordids, $sourcemodule);	
modules/SMSNotifier/workflow/VTSMSTask.php:51:			SMSNotifier::sendsms($content, $tonumbers, $current_user->id, $relatedCRMid, $relatedModule);
modules/TestModule/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/TestModule/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/TestModule/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/TestModule/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/TestModule/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/TestModule/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/TestModule/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/TestModule/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/TestModule/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/TestModule/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/TestModule/TestModule.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/TestModule/TestModule.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/TestModule/TestModule.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/TestModule/TestModule.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/TestModule/TestModule.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/TestModule/TestModule.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/TestModule/TestModule.php:289:		if($record_user != $current_user->id){
modules/TestModule/TestModule.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/TestModule/TestModule.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/uploads/add2db.php:48:			$params = array($current_id, $current_user->id, $current_user->id, $_REQUEST['return_module'].' Attachment', $desc, $date_var, $current_date);	
modules/Users/AddMailAccount.php:92:$qry_res = $adb->pquery("select * from vtiger_mail_accounts where user_id=?", array($current_user->id));
modules/Users/AddMailAccount.php:111:$smarty->assign("USERID", $current_user->id);
modules/Users/Announcements.php:20:$result=$adb->pquery($query, array($current_user->id));
modules/Users/DetailView.php:141:if(!in_array($block['User Login & Role'][0]['User Name']['value'], $supremeAdmins) || $current_user->isSupreme){
modules/Users/DetailView.php:142:	if ((is_admin($current_user) || $_REQUEST['record'] == $current_user->id)
modules/Users/DetailView.php:150:	elseif (is_admin($current_user) || $_REQUEST['record'] == $current_user->id) {
modules/Users/DetailView.php:160:		if($current_user->isSupreme){
modules/Users/DetailView.php:167:		if($_REQUEST['record'] != $current_user->id)
modules/Users/DetailView.php:176:			$buttons = "<input title='".$app_strings['LBL_LISTROLES_BUTTON_TITLE']."' accessKey='".$app_strings['LBL_LISTROLES_BUTTON_KEY']."' class='classBtn' onclick=\"this.form.return_module.value='Users'; this.form.return_action.value='TabCustomise'; this.form.action.value='listroles'; this.form.record.value= '". $current_user->id ."'\" type='submit' name='ListRoles' value=' ".$app_strings['LBL_LISTROLES_BUTTON_LABEL']." '>";
modules/Users/DetailView.php:193:if($current_user->id == $_REQUEST['record'] || is_admin($current_user) == true)
modules/Users/DetailView.php:199:$smarty->assign("CURRENT_USERID", $current_user->id);
modules/Users/EditView.php:43:	if (!is_admin($current_user) && $_REQUEST['record'] != $current_user->id) die ("Unauthorized access to user administration.");
modules/Users/EditView.php:76:$smarty->assign("CURRENT_USERID", $current_user->id);
modules/Users/getListOfRecords.php:49:	if(getFieldVisibilityPermission($sModule,$current_user->id, $checkForFieldAccess) == '0'){
modules/Users/ListView.php:16:if($current_user->is_admin != 'on')
modules/Users/ListView.php:38:if($current_user->isSupreme){
modules/Users/ListView.php:53:if(!$current_user->isSupreme){
modules/Users/ListView.php:123:$smarty->assign("CURRENT_USERID", $current_user->id);
modules/Users/LoginHistory.php:191:			$where .=" AND user_name = '". $adb->sql_escape_string($current_user->user_name) ."'";
modules/Users/LoginHistory.php:197:			$query .= " WHERE user_name = '". $adb->sql_escape_string($current_user->user_name) ."'";
modules/Users/Logout.php:41:        $loghistory->user_logout($current_user->user_name,$usip,$outtime);
modules/Users/lookupemailtemplates.php:44:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Users/populatetemplate.php:66:$result = $adb->pquery($query, array($current_user->id));
modules/Users/Save.php:62:if (isset($_POST['record']) && !is_admin($current_user) && $_POST['record'] != $current_user->id) echo ("Unauthorized access to user administration.");
modules/Users/Save.php:99:	if(strtolower($current_user->is_admin) == 'off'  && $current_user->id != $focus->id)
modules/Users/Save.php:101:		$log->fatal("SECURITY:Non-Admin ". $current_user->id . " attempted to change settings for user:". $focus->id);
modules/Users/Save.php:105:	if(strtolower($current_user->is_admin) == 'off'  && isset($_POST['is_admin']) && strtolower($_POST['is_admin']) == 'on')
modules/Users/Save.php:107:		$log->fatal("SECURITY:Non-Admin ". $current_user->id . " attempted to change is_admin settings for user:". $focus->id);
modules/Users/Save.php:175:	$email_body .= "<br>" . $app_strings['MSG_THANKS'] . "<br>" . $current_user->user_name;
modules/Users/SaveMailAccount.php:14:$userid = $current_user->id;
modules/Users/SaveMailAccount.php:46:	$params = array($account_id, $current_user->id, $displayname, $email, $account_name, $mailprotocol, $server_username, $encrypted_password, $mail_servername, $box_refresh, $mails_per_page, $ssltype, $sslmeth, $_REQUEST["int_mailer"],'1','0');
modules/Users/updateLeadDBStatus.php:55:			$result = $adb->pquery($sql, array($current_user->id, $idval, $adb->formatDate($date_var, true), $id));
modules/Users/updateLeadDBStatus.php:74:				$result1 = $adb->pquery($query, array($current_user->id, $adb->formatDate($date_var, true), $id));
modules/Users/Users.php:835:                if($current_user->id == $this->id) {
modules/Users/Users.php:849:                if($current_user->id == $this->id) {
modules/Users/Users.php:1009:            $ownerid = $current_user->id;
modules/Users/Users.php:1034:            $params1 = array($current_id, $current_user->id, $ownerid, $module." Attachment", $this->column_fields['description'], $this->db->formatString("vtiger_crmentity","createdtime",$date_var), $this->db->formatDate($date_var, true));
modules/Users/Users.php:1424:                $current_user->id, $id), true,"Error marking record deleted: ");
modules/Vendors/DetailView.php:106:$focus->markAsViewed($current_user->id);
modules/VisaA/DetailView.php:103:$focus->markAsViewed($current_user->id);
modules/VisaA/ModuleFooter.php:140:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/VisaA/ModuleFooter.php:141:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/VisaA/ModuleFooter.php:149:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/VisaA/ModuleFooter.php:159:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/VisaA/ModuleFooter.php:172:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/VisaA/ModuleFooter.php:250:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/VisaA/ModuleFooter.php:288:		if($record_user != $current_user->id){
modules/VisaA/ModuleFooter.php:291:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/VisaA/ModuleFooter.php:297:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/VisaA/VisaA.php:141:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/VisaA/VisaA.php:142:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
modules/VisaA/VisaA.php:150:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
modules/VisaA/VisaA.php:160:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
modules/VisaA/VisaA.php:173:							WHERE userid=".$current_user->id." and tabid=".$tabid."
modules/VisaA/VisaA.php:251:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
modules/VisaA/VisaA.php:289:		if($record_user != $current_user->id){
modules/VisaA/VisaA.php:292:				$this->column_fields["assigned_user_id"] = $current_user->id;
modules/VisaA/VisaA.php:298:					$this->column_fields["assigned_user_id"] = $current_user->id;
modules/Vtiger/header.php:36:$userName = getFullNameFromArray('Users', $current_user->column_fields);
modules/Vtiger/header.php:55:$smarty->assign("CURRENT_USER_MAIL", $current_user->email1);
modules/Vtiger/header.php:56:$smarty->assign("CURRENT_USER", $current_user->user_name);
modules/Vtiger/header.php:57:$smarty->assign("CURRENT_USER_ID", $current_user->id);
modules/Vtiger/header.php:63:$smarty->assign("USE_ASTERISK", get_use_asterisk($current_user->id));
modules/Vtiger/header.php:81:$list = $tracFocus->get_recently_viewed($current_user->id);
modules/Webforms/index.php:12:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Webforms/model/WebformsModel.php:277:		$dateformat=$current_user->date_format;
modules/Webforms/WebformsEditView.php:46:$smarty->assign('DATE_FORMAT', $current_user->date_format);
modules/Webforms/WebformsFieldsView.php:34:$smarty->assign('DATE_FORMAT', $current_user->date_format);
modules/Webforms/WebformsListView.php:13:require('user_privileges/user_privileges_'.$current_user->id.'.php');
modules/Webmails/body.php:18:if(!isset($_SESSION["authenticated_user_id"]) || $_SESSION["authenticated_user_id"] != $current_user->id) {echo "ajax failed";flush();exit();}
modules/Webmails/ListView.php:407:$smarty->assign("USERID", $current_user->id);
modules/Webmails/MailBox.php:227:				echo "<br>&nbsp;<b>".$mod_strings['LBL_MAIL_CONNECT_ERROR']."<a href='index.php?module=Users&action=AddMailAccount&return_module=Webmails&return_action=index&record=".$current_user->id."'> ".$mod_strings['LBL_HERE']."</a>. ".$mod_strings['LBL_PLEASE']." <a href='index.php?module=Emails&action=index&parenttab=".vtlib_purify($_REQUEST['parenttab'])."'>".$mod_strings['LBL_CLICK_HERE']."</a>".$mod_strings['LBL_GOTO_EMAILS_MODULE']." </b>";
modules/Webmails/Save.php:51:$focus->column_fields["assigned_user_id"] = $current_user->id;
modules/Webmails/Save.php:62:$user_old_date_format = $current_user->date_format;
modules/Webmails/Save.php:63:$current_user->date_format = 'yyyy-mm-dd';
modules/Webmails/Save.php:88:	$contact_focus->column_fields["assigned_user_id"]=$current_user->id;
modules/Webmails/Save.php:133:            $qparams = array($current_id, $current_user->id, $current_user->id, 'Contacts Attachment', 'Uploaded from webmail during qualification', $date_var, $date_var);
modules/Webmails/Save.php:151:					$document->column_fields['assigned_user_id'] = $current_user->id;
modules/Webmails/Save.php:177:$current_user->date_format = $user_old_date_format;
soap/customerportal.php:721:			getColumnVisibilityPermission($current_user->id,$fieldname,'HelpDesk');
soap/customerportal.php:907:	$current_user->id = $userid;
soap/customerportal.php:1104:	$mail->AddReplyTo($current_user->name);
soap/customerportal.php:1647:			$columnVisibilityByFieldnameInfo[$fieldname] = getColumnVisibilityPermission($current_user->id,$fieldname,$module);
soap/customerportal.php:1989:		$fieldper = getFieldVisibilityPermission($module,$current_user->id,$fieldname);
soap/customerportal.php:2126:				$fieldper = getFieldVisibilityPermission('Products',$current_user->id,$fieldname);
soap/customerportal.php:2313:		$fieldper = getFieldVisibilityPermission($module,$current_user->id,$fieldname);
soap/customerportal.php:2804:			$componentfieldVisibilityByColumn[$fieldname] = getColumnVisibilityPermission($current_user->id,$fieldname,$module);
soap/customerportal.php:2873:			$TicketsfieldVisibilityByColumn[$fieldname] = getColumnVisibilityPermission($current_user->id,$fieldname,'HelpDesk');
soap/customerportal.php:3018:			getFieldVisibilityPermission('Services',$current_user->id,$fieldname);
soap/firefoxtoolbar.php:217:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:237:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:257:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:277:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:297:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:317:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:337:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:357:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:377:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:400:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:468:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:509:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:548:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:588:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:629:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:676:	$current_user->retrieve_entity_info($user_id,'Users');
soap/firefoxtoolbar.php:727:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/firefoxtoolbar.php:777:	$current_user->retrieve_entity_info($user_id,'Users');
soap/firefoxtoolbar.php:835:	$current_user->retrieve_entity_info($user_id,'Users');
soap/firefoxtoolbar.php:838:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/thunderbirdplugin.php:226:		$user_id = $current_user->retrieve_user_id($user_name);
soap/thunderbirdplugin.php:230:		$current_user = $current_user->retrieveCurrentUserInfoFromFile($user_id);
soap/thunderbirdplugin.php:384:		$current_user->retrieve_entity_info($user_id,"Users");
soap/thunderbirdplugin.php:385:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/thunderbirdplugin.php:386:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
soap/thunderbirdplugin.php:449:		$current_user->retrieve_entity_info($user_id,"Users");
soap/thunderbirdplugin.php:450:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/thunderbirdplugin.php:451:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
soap/thunderbirdplugin.php:592:		$current_user->retrieve_entity_info($user_id,"Users");
soap/thunderbirdplugin.php:612:		$current_user->retrieve_entity_info($user_id,"Users");
soap/thunderbirdplugin.php:631:		$current_user->retrieve_entity_info($user_id,"Users");
soap/thunderbirdplugin.php:649:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:321:	$user_id = $current_user->retrieve_user_id($username);
soap/vtigerolservice.php:325:	$current_user = $current_user->retrieveCurrentUserInfoFromFile($user_id);
soap/vtigerolservice.php:407:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/vtigerolservice.php:427:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/vtigerolservice.php:447:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/vtigerolservice.php:611:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:615:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:616:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:700:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:703:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:704:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:771:			$user_old_date_format = $current_user->date_format;
soap/vtigerolservice.php:772:			$current_user->date_format = 'yyyy-mm-dd';
soap/vtigerolservice.php:774:			$current_user->date_format = $user_old_date_format;
soap/vtigerolservice.php:792:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:923:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:925:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:926:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:1011:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:1013:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:1014:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:1102:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:1182:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:1184:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:1185:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:1258:	$current_user->retrieve_entity_info($user_id,"Users");
soap/vtigerolservice.php:1260:	require('user_privileges/user_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:1261:	require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
soap/vtigerolservice.php:1334:	$current_user->retrieve_entity_info($user_id,"Users");
soap/wordplugin.php:223:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/wordplugin.php:247:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/wordplugin.php:273:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/wordplugin.php:299:	$current_user->retrieve_entity_info($user_id, 'Users');
soap/wordplugin.php:325:	$current_user->retrieve_entity_info($user_id, 'Users');
themes/1819751b17950db85f2.99018777install/PopulateSeedData.php:106:$result = $current_user->retrieve_entity_info($assigned_user_id,'Users');
vtlib/ModuleDir/5.0.4/ModuleFile.php:137:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.0.4/ModuleFile.php:138:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.0.4/ModuleFile.php:146:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
vtlib/ModuleDir/5.0.4/ModuleFile.php:156:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
vtlib/ModuleDir/5.0.4/ModuleFile.php:174:							WHERE userid=".$current_user->id." and tabid=".$tabid."
vtlib/ModuleDir/5.0.4/ModuleFile.php:219:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.0.4/ModuleFile.php:220:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.1.0/DetailView.php:95:$focus->markAsViewed($current_user->id);
vtlib/ModuleDir/5.1.0/ModuleFile.php:185:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.1.0/ModuleFile.php:186:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.1.0/ModuleFile.php:194:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
vtlib/ModuleDir/5.1.0/ModuleFile.php:204:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
vtlib/ModuleDir/5.1.0/ModuleFile.php:217:							WHERE userid=".$current_user->id." and tabid=".$tabid."
vtlib/ModuleDir/5.1.0/ModuleFile.php:272:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.1.0/ModuleFile.php:273:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.1.0/ModuleFile.php:303:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
vtlib/ModuleDir/5.1.0/ModuleFile.php:341:		if($record_user != $current_user->id){
vtlib/ModuleDir/5.1.0/ModuleFile.php:344:				$this->column_fields["assigned_user_id"] = $current_user->id;
vtlib/ModuleDir/5.1.0/ModuleFile.php:350:					$this->column_fields["assigned_user_id"] = $current_user->id;
vtlib/ModuleDir/5.2.0/DetailView.php:103:$focus->markAsViewed($current_user->id);
vtlib/ModuleDir/5.2.0/ModuleFile.php:199:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.2.0/ModuleFile.php:200:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.2.0/ModuleFile.php:208:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
vtlib/ModuleDir/5.2.0/ModuleFile.php:218:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
vtlib/ModuleDir/5.2.0/ModuleFile.php:231:							WHERE userid=".$current_user->id." and tabid=".$tabid."
vtlib/ModuleDir/5.2.0/ModuleFile.php:309:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
vtlib/ModuleDir/5.2.0/ModuleFile.php:347:		if($record_user != $current_user->id){
vtlib/ModuleDir/5.2.0/ModuleFile.php:350:				$this->column_fields["assigned_user_id"] = $current_user->id;
vtlib/ModuleDir/5.2.0/ModuleFile.php:356:					$this->column_fields["assigned_user_id"] = $current_user->id;
vtlib/ModuleDir/5.3.0/DetailView.php:103:$focus->markAsViewed($current_user->id);
vtlib/ModuleDir/5.3.0/ModuleFile.php:199:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.3.0/ModuleFile.php:200:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.3.0/ModuleFile.php:208:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
vtlib/ModuleDir/5.3.0/ModuleFile.php:218:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
vtlib/ModuleDir/5.3.0/ModuleFile.php:231:							WHERE userid=".$current_user->id." and tabid=".$tabid."
vtlib/ModuleDir/5.3.0/ModuleFile.php:309:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
vtlib/ModuleDir/5.3.0/ModuleFile.php:347:		if($record_user != $current_user->id){
vtlib/ModuleDir/5.3.0/ModuleFile.php:350:				$this->column_fields["assigned_user_id"] = $current_user->id;
vtlib/ModuleDir/5.3.0/ModuleFile.php:356:					$this->column_fields["assigned_user_id"] = $current_user->id;
vtlib/ModuleDir/5.4.0/DetailView.php:103:$focus->markAsViewed($current_user->id);
vtlib/ModuleDir/5.4.0/ModuleFile.php:199:		require('user_privileges/user_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.4.0/ModuleFile.php:200:		require('user_privileges/sharing_privileges_'.$current_user->id.'.php');
vtlib/ModuleDir/5.4.0/ModuleFile.php:208:				$sec_query .= " AND (vtiger_crmentity.smownerid in($current_user->id) OR vtiger_crmentity.smownerid IN 
vtlib/ModuleDir/5.4.0/ModuleFile.php:218:						WHERE userid=".$current_user->id." AND tabid=".$tabid."
vtlib/ModuleDir/5.4.0/ModuleFile.php:231:							WHERE userid=".$current_user->id." and tabid=".$tabid."
vtlib/ModuleDir/5.4.0/ModuleFile.php:309:			WHERE vtiger_users_last_import.assigned_user_id='$current_user->id'
vtlib/ModuleDir/5.4.0/ModuleFile.php:347:		if($record_user != $current_user->id){
vtlib/ModuleDir/5.4.0/ModuleFile.php:350:				$this->column_fields["assigned_user_id"] = $current_user->id;
vtlib/ModuleDir/5.4.0/ModuleFile.php:356:					$this->column_fields["assigned_user_id"] = $current_user->id;
vtlib/Vtiger/Event.php:92:					$current_user->id = $moduleInstance->column_fields['assigned_user_id'];
vtlib/Vtiger/Link.php:188:					if(count($permittedTabIdList) > 0 && $current_user->is_admin !== 'on') {
